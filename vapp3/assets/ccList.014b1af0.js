import{c as y}from"./ccItem.41f95b20.js";import{_ as S,r as n,o as l,c,a as i,w as d,F as w,b as k,g as h,h as u}from"./index.6e7bc473.2022_10_28_19_14_01.js";const C={components:{ccItem:y},props:{dataSource:{default:[]},itemKey:{},showKeys:{},params:{default:{title:"",page:1,size:20,text:"",menus:[]}}},data(){return{refreshing:!1,loading:!1,finished:!1,error:!1,text:"",menus:[{value:"",options:this.options1},{value:"desc",options:[{text:"\u6B63\u5E8F",value:"ase"},{text:"\u5012\u5E8F",value:"desc"}]}]}},computed:{options1(){return Object.keys(this.dataSource.reduce((t,e)=>({...t,...e}),{})).map(t=>({text:t,value:t}))}},watch:{text(){this.params.text=this.text}},created(){this.text=this.params.text},methods:{onConfirm(){},onRefresh(){this.loadData({page:1})},loadNextPage(){this.loading||(console.log("loadNextPage"),this.loadData({page:this.dataSource.length===0?1:this.params.page+1}))},loadData(t){t={...this.params,...t,order:"desc",sort:""},this.loading=!0,this.$emit("loadData",{...t,callback:e=>{Array.isArray(e)?e.length==0?this.finished=!0:(this.params.page=t.page,t.page===1?(this.finished=!1,this.dataSource.splice(0,this.dataSource.length,...e)):this.dataSource.splice(this.dataSource.length,0,...e)):this.error=!0,this.loading=!1,this.refreshing=!1,this.error=!1}})},open(){this.$emit("open",...arguments)}}},L={class:"ccList"};function R(t,e,o,K,s,r){const m=n("van-dropdown-item"),f=n("van-dropdown-menu"),p=n("van-search"),_=n("ccItem"),g=n("van-list"),v=n("van-pull-refresh");return l(),c("div",L,[o.params.menus&&o.params.menus.length?(l(),i(f,{key:0},{default:d(()=>[(l(!0),c(w,null,k(o.params.menus,(a,x)=>(l(),i(m,{key:x,modelValue:a.value,"onUpdate:modelValue":V=>a.value=V,options:a.options,onChange:r.onRefresh},null,8,["modelValue","onUpdate:modelValue","options","onChange"]))),128))]),_:1})):h("",!0),o.params.menus&&o.params.menus.text!==void 0?(l(),i(p,{key:1,modelValue:s.text,"onUpdate:modelValue":e[0]||(e[0]=a=>s.text=a),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",onSearch:r.onRefresh},null,8,["modelValue","onSearch"])):h("",!0),u(v,{modelValue:s.refreshing,"onUpdate:modelValue":e[2]||(e[2]=a=>s.refreshing=a),onRefresh:r.onRefresh},{default:d(()=>[u(g,{modelValue:s.loading,"onUpdate:modelValue":e[1]||(e[1]=a=>s.loading=a),finished:s.finished,error:s.error,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:r.loadNextPage,style:{"min-height":"50vh"}},{default:d(()=>[u(_,{title:o.params.title,dataSource:o.dataSource,onOpen:r.open,showKeys:o.showKeys},null,8,["title","dataSource","onOpen","showKeys"])]),_:1},8,["modelValue","finished","error","onLoad"])]),_:1},8,["modelValue","onRefresh"])])}const D=S(C,[["render",R],["__scopeId","data-v-e37ed9a5"]]);export{D as c};
