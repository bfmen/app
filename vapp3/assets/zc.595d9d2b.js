import{appStore as f}from"./index.cf6fdeae.js";import"./index.ea894667.js";import{_ as b,o as u,c,l as i,p as h,q as a,s as d,v as _,F as w,r as v,x as k,y,z as T}from"./index.daa3e381.2024_03_12_10_44_37.js";const B={mixins:[],data(){return{port:{},reader:{},isOpen:!1,dataR:"",dataW:"",timer:null,reader:{},writer:{},list:[],checked:[],imei:"",ip:"192.168.0.1"}},computed:{appStore:()=>f},created(){window.that=this,this.timer=setInterval(()=>{this.isOpen=!!this.port.readable},100)},methods:{async click(){try{if(this.port.getInfo&&this.port.readable)this.reader.releaseLock(),this.writer.releaseLock(),await this.port.close(),this.reader={};else{const e=await navigator.serial.requestPort();this.port=e,this.port.readable||(await e.open({dataBits:8,stopBits:1,parity:"none",baudRate:9600}),this.reader=this.port.readable.getReader(),this.writer=this.port.writable.getWriter(),this.write("AT+CGSN"),setTimeout(()=>{this.getBand()},200))}}catch(e){console.log("error",e)}},getBand(){this.write("AT+ZLTEAMTBAND?"),setTimeout(()=>{this.write("AT+ZLTEBAND?")},100)},async read(){const e=this.reader,{value:t,done:o}=await e.read();let l=x(t);console.log("\u63A5\u6536",l),this.dataR+=l,this.dataHandler(l)},async write(e){const t=this.writer;let o=(e||this.dataW)+`\r
`;console.log("\u53D1\u9001",o);let l=A(o);await t.write(l),setTimeout(()=>{this.read()},100)},dataHandler(e){let t="ZLTEAMTBAND: ";if(e.includes(t)&&(this.list=this.getSupportedBand(e.split(t)[1].split(`\r
`)[0])),t="+ZLTEBAND: ",e.includes(t)){let o=this.getLockedBand(e.split(t)[1].split(`\r
`)[0]);this.checked=o}t="+CGSN: ",e.includes(t)&&(this.imei=e.split(t)[1].split(`\r
`)[0])},getSupportedBand(e){return e.split(",").reduce((t,o,l)=>{let s=parseInt(o).toString(2);for(var n=0;n<s.length;n++)parseInt(s[s.length-n-1])&&t.push(l*8+n+1);return t},[])},getLockedBand(e){return this.getSupportedBand(e).filter(t=>this.list.includes(t))},submit(){let e=[];for(var t=0;t<8;t++){let l="";for(var o=0;o<8;o++)this.checked.includes(t*8+o+1)?l="1"+l:l="0"+l;e.push(parseInt(l,2))}this.write("AT+ZLTEBAND="+e.join(","))},async reboot(){let e=await fetch(`http://${this.ip}/goform/goform_set_cmd_process?goformId=REBOOT_DEVICE`);alert(e.statusText)},async openADB(){await fetch(`http://${this.ip}/goform/goform_set_cmd_process?goformId=SET_DEVICE_MODE&debug_enable=2`),await fetch(`http://${this.ip}/goform/goform_set_cmd_process?goformId=SET_DEVICE_MODE&debug_enable=1`),this.reboot()},async closeADB(){await fetch(`http://${this.ip}/goform/goform_set_cmd_process?goformId=SET_DEVICE_MODE&debug_enable=0`),this.reboot()}},unmounted(){clearInterval(this.timer)},watch:{dataR(){this.$nextTick(()=>{const e=document.getElementById("scroll_text");e.scrollTop=e.scrollHeight})}}};function x(e){for(var t="",o=0;o<e.length;o++)t+=String.fromCharCode(e[o]);return t}function A(e){for(var t=[],o=0;o<e.length;o++)t.push(e.charCodeAt(o));var l=new Uint8Array(t);return l}const p=e=>(y("data-v-36d8be50"),e=e(),T(),e),E={class:"atTool",style:{padding:"10px"}},I=p(()=>i("label",null,"ip: ",-1)),S={class:"content"},C={style:{padding:"10px 0"}},D=p(()=>i("label",null,"IMEI: ",-1)),L={style:{display:"flex","flex-wrap":"wrap","align-items":"center",padding:"10px 0"}},M={for:"option1"},O=["value"],V=p(()=>i("br",null,null,-1)),N=p(()=>i("br",null,null,-1)),R={class:"right"};function U(e,t,o,l,s,n){return u(),c("div",E,[i("button",{onClick:t[0]||(t[0]=(...r)=>n.click&&n.click(...r))},"\u9009\u62E9\u7AEF\u53E3 "+h(s.isOpen?"\uFF08\u5DF2\u5F00\u542F\uFF09":"\uFF08\u672A\u5F00\u542F\uFF09"),1),i("div",null,[I,a(i("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=r=>s.ip=r)},null,512),[[d,s.ip]]),i("button",{onClick:t[2]||(t[2]=(...r)=>n.openADB&&n.openADB(...r))},"\u5F00\u542Fadb "),i("button",{onClick:t[3]||(t[3]=(...r)=>n.closeADB&&n.closeADB(...r))},"\u5173\u95EDadb "),i("button",{onClick:t[4]||(t[4]=(...r)=>n.reboot&&n.reboot(...r))},"\u91CD\u542F")]),a(i("div",S,[i("div",C,[D,a(i("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=r=>s.imei=r)},null,512),[[d,s.imei]]),i("button",{onClick:t[6]||(t[6]=r=>n.write("AT+CGSN"))},"\u8BFB\u53D6"),i("button",{onClick:t[7]||(t[7]=r=>n.write("AT+MODIMEI="+s.imei))},"\u5199\u5165")]),i("div",L,[(u(!0),c(w,null,v(s.list,(r,m)=>(u(),c("span",{key:m,style:{display:"flex","flex-wrap":"wrap","align-items":"center",padding:"0 5px"}},[i("label",M,"LTE B"+h(r),1),a(i("input",{type:"checkbox",id:"option1",name:"options[]","onUpdate:modelValue":t[8]||(t[8]=g=>s.checked=g),value:r},null,8,O),[[k,s.checked,void 0,{number:!0}]]),V,N]))),128)),i("button",{onClick:t[9]||(t[9]=(...r)=>n.getBand&&n.getBand(...r))},"\u8BFB\u53D6\u9891\u6BB5"),i("button",{onClick:t[10]||(t[10]=(...r)=>n.submit&&n.submit(...r))},"\u9501\u5B9A\u9891\u6BB5")]),i("div",null,[a(i("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=r=>s.dataW=r),placeholder:"\u53D1\u9001\u81EA\u5B9A\u4E49AT\u6307\u4EE4"},null,512),[[d,s.dataW]]),i("button",{onClick:t[12]||(t[12]=r=>n.write())},"\u53D1\u9001")]),i("div",R,[a(i("textarea",{id:"scroll_text",cols:"30",rows:"10","onUpdate:modelValue":t[13]||(t[13]=r=>s.dataR=r),readonly:""},null,512),[[d,s.dataR]]),i("button",{onClick:t[14]||(t[14]=r=>s.dataR="")},"\u6E05\u7406")])],512),[[_,s.isOpen]])])}const G=b(B,[["render",U],["__scopeId","data-v-36d8be50"]]);export{G as default};
