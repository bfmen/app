const Config={bmobDefaultAccount:{applicationId:"b7d2ba4c899fb0371e6ca184df301141",restApiKey:"a0af24c5cd6196b9457f0b56c420192a",masterKey:"7acfea947e08ce49572a66b72089194e",wechatApp:"wechatApp"},bmobUrl:"https://api.bmobcloud.com/1",bmobAccountTableName:"BmobAccount",bmobAccount:null,bmobAccountCallbacks:[],isBmobAccountLoading:!1,functionName:"request"},Request=e=>{debugger;var c=new Date().valueOf();return new Promise(function(n,t){e&&e.headers&&e.headers.Referer||!(window&&window.uni)&&e.url.indexOf(Config.bmobUrl)!=0?(print(),Config.bmobAccount==null?Config.isBmobAccountLoading==!0?rConfig.bmobAccountCallbacks.push({params:e,resolve:n,reject:t}):find(Config.bmobAccountTableName,{limit:"100",order:"-dueDate"}).then(o=>{Config.isBmobAccountLoading=!1,o.length==0||o[0].dueDate.iso<formatTime(new Date)?t("BmobAccount\u5168\u90E8\u8FC7\u671F"):(Config.bmobAccount=o[0],Config.bmobAccountCallbacks.map(function(u){cloudRun({functionName:"request",bmobAccount:Config.bmobAccount,params:u.params,resolve:u.resolve,reject:u.reject})}),Config.bmobAccountCallbacks=[],cloudRun({functionName:"request",bmobAccount:Config.bmobAccount,params:e,resolve:n,reject:t}))}).catch(o=>{Config.isBmobAccountLoading=!1}):cloudRun({functionName:"request",bmobAccount:Config.bmobAccount,params:e,resolve:n,reject:t})):window&&window.uni?(print(),e.data=e.params,e.header=e.headers,e.params=void 0,e.headers=void 0,e.success=o=>{n(o.data)},e.fail=o=>{t(o)},uni.request(e)):window.wx?(print(),e.data=e.params,e.header=e.headers,e.params=void 0,e.headers=void 0,e.success=o=>{n(o.data)},e.fail=o=>{t(o)},wx.request(e)):(print(),window.axios(e).then(o=>{n(o.data)}).catch(o=>{t(o)}))}).then(n=>(print(c,(new Date().valueOf()-c)/1e3+"s"),n)).catch(n=>(print(c,(new Date().valueOf()-c)/1e3+"s"),n))};function cloudRun({functionName,bmobAccount,params,resolve,reject}){return new Date().valueOf(),print(),Request({method:"POST",url:Config.bmobUrl+"/functions/"+functionName,data:params,headers:{"X-Bmob-Application-Id":bmobAccount.applicationId,"X-Bmob-Master-Key":bmobAccount.masterKey,"X-Bmob-REST-API-Key":bmobAccount.restApiKey,"X-Bmob-SDK-Type":"wechatApp"}}).then(res=>{var response=JSON.parse(res.result);response.body=eval("("+response.body+")"),resolve(response.body)}).catch(e=>{reject(e)})}function find(e,c={}){return Request({url:Config.bmobUrl+"/classes/"+e,params:c,headers:{"X-Bmob-Application-Id":Config.bmobDefaultAccount.applicationId,"X-Bmob-Master-Key":Config.bmobDefaultAccount.masterKey,"X-Bmob-REST-API-Key":Config.bmobDefaultAccount.restApiKey,"X-Bmob-SDK-Type":"wechatApp"}}).then(n=>n.results).catch(n=>n)}const print=e=>{};function formatTime(e){var c=e.getFullYear(),n=e.getMonth()+1,t=e.getDate(),o=e.getHours(),u=e.getMinutes(),i=e.getSeconds();return[c,n,t].map(formatNumber).join("-")+" "+[o,u,i].map(formatNumber).join(":")}function formatNumber(e){return e=e.toString(),e[1]?e:"0"+e}export{Request as default,find};
