import{m as i}from"./index.a47189db.js";import{c as h}from"./ccItem.a9fc3319.js";import{_ as y}from"./data.0560ed88.js";import{_,r as p,o as x,c as w,h as d,w as c}from"./index.89adf607.2022_10_28_16_19_51.js";import"./ccImg.7dc286a0.js";import"./index.1f5a94d8.js";const g={mixins:[y],components:{ccItem:h},data(){return{page:-1,refreshing:!1,loading:!1,finished:!1,inputText:"",list:[],placeholder:"placeholder",title:""}},computed:{showKeys(){return[{key:"views",type:"primary"},{key:"name",type:"success"},{key:"duration",type:"danger"},{key:"hd",type:"warning"}]}},async created(){},methods:{onRefresh(){this.loadData()},async loadData(l=0){l<0&&(l=0);let e=l===0?i.config.url:`${i.config.url}/new/${l}`;this.inputText&&(e=l===0?`${i.config.url}?k=${this.inputText}`:`${i.config.url}?k=${this.inputText}&p=${this.page}`);let u=await i.axios({params:{uuu:e}}),n=i.utils.format.list(u.data);this.list=l===0?n.list:[...this.list,...n.list],this.title=n.title,this.page=l,this.loading=!1,this.refreshing=!1},async open(l,e){if(l&&e.href&&!e.detail_src){let u=await i.axios({params:{uuu:e.href}}),n=i.utils.format.detail(u.data);e.detail_src=n.src;let s=await i.axios({params:{uuu:n.src}}),o=n.src.split("/");o.pop();let f=o.join("/"),m=s.data.split(`
`).map(t=>[".ts",".m3u8"].some(a=>t.includes(a))?t.startsWith("http")?t:`${f}/${t}`:t).filter(t=>t.includes(".m3u8")).map(t=>({url:t,title:t.split("/videos/")[1].split("/hls-")[1].split("-")[0]})).sort((t,a)=>parseInt(a.title)-parseInt(t.title));e.playList=m}}}};function v(l,e,u,n,s,o){const f=p("van-search"),m=p("ccItem"),t=p("van-list"),a=p("van-pull-refresh");return x(),w("div",null,[d(a,{modelValue:s.refreshing,"onUpdate:modelValue":e[4]||(e[4]=r=>s.refreshing=r),onRefresh:o.onRefresh},{default:c(()=>[d(f,{modelValue:s.inputText,"onUpdate:modelValue":e[0]||(e[0]=r=>s.inputText=r),placeholder:s.placeholder+"",onSearch:e[1]||(e[1]=r=>o.loadData(0))},null,8,["modelValue","placeholder"]),d(t,{modelValue:s.loading,"onUpdate:modelValue":e[2]||(e[2]=r=>s.loading=r),finished:s.finished,"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:e[3]||(e[3]=r=>o.loadData(++s.page))},{default:c(()=>[d(m,{title:s.title,dataSource:s.list,onOpen:o.open,showKeys:o.showKeys},null,8,["title","dataSource","onOpen","showKeys"])]),_:1},8,["modelValue","finished"])]),_:1},8,["modelValue","onRefresh"])])}const D=_(g,[["render",v]]);export{D as default};
