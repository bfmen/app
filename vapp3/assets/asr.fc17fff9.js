import{appStore as c}from"./index.7f258ca4.js";import"./index.f25c3be7.js";import{_ as f,o as b,c as v,l as i,p as w,q as d,v as m,s as p,F as g,r as k,x as S,y as A,z as T}from"./index.60d2c820.2024_04_03_04_20_21.js";const y={mixins:[],data(){return{port:{},reader:{},isOpen:!1,dataR:"",dataW:"",timer:null,reader:{},writer:{},list:[1,3,5,8,38,39,40,41],checked:[],imei:"",sn:"",bandStr:"",ip:"192.168.0.1"}},computed:{appStore:()=>c},created(){window.that=this,this.timer=setInterval(()=>{this.isOpen=!!this.port.readable},100)},methods:{async click(){try{if(this.port.getInfo&&this.port.readable)this.reader.releaseLock(),this.writer.releaseLock(),await this.port.close(),this.reader={};else{const e=await navigator.serial.requestPort();this.port=e,this.port.readable||(await e.open({dataBits:8,stopBits:1,parity:"none",baudRate:9600}),this.reader=this.port.readable.getReader(),this.writer=this.port.writable.getWriter(),this.write("AT+CGSN"),this.write("AT*MRD_SN?"),setTimeout(()=>{this.write("AT*MRD_SN?")},100),setTimeout(()=>{this.getBand()},200))}}catch(e){console.log("error",e)}},getBand(){this.write("AT*BAND?")},async read(){const e=this.reader,{value:t,done:s}=await e.read();let o=C(t);console.log("\u63A5\u6536",o),this.dataR+=o,this.dataHandler(o)},async write(e){const t=this.writer;let s=(e||this.dataW)+`\r
`;console.log("\u53D1\u9001",s);let o=x(s);await t.write(o),setTimeout(()=>{this.read()},100)},dataHandler(e){let t="ZLTEAMTBAND: ";if(t="*BAND:",e.includes(t)&&e.length>20){this.bandStr=e.split(t)[1].split(`\r
`)[0];let s=e.split(","),o=parseInt(s[3]).toString(2).split("").reverse(),l=parseInt(s[4]).toString(2).split("").reverse(),n=[];o.forEach((r,a)=>{r==="1"&&(a===5&&n.push(38),a===6&&n.push(39),a===7&&n.push(40),a===8&&n.push(41))}),l.forEach((r,a)=>{r==="1"&&[1,3,5,8].includes(a+1)&&n.push(a+1)}),this.checked=n}t="+CGSN: ",e.includes(t)&&(this.imei=e.split(t)[1].split(`\r
`)[0]),t="*MRD_SN:",e.includes(t)&&(this.sn=e.split(t)[1].split(`\r
`)[0])},submit(){let e=0,t=0;this.checked.forEach(l=>{l<=20&&(t+=Math.pow(2,l-1)),l>=38&&l<=41&&(e+=Math.pow(2,l-33))});let s=this.bandStr.split(",");s[3]=e,s[4]=t;let o=`AT*BAND=${s.join(",")}`;this.write(o)}},unmounted(){clearInterval(this.timer)},watch:{dataR(){this.$nextTick(()=>{const e=document.getElementById("scroll_text");e.scrollTop=e.scrollHeight})}}};function C(e){for(var t="",s=0;s<e.length;s++)t+=String.fromCharCode(e[s]);return t}function x(e){for(var t=[],s=0;s<e.length;s++)t.push(e.charCodeAt(s));var o=new Uint8Array(t);return o}const u=e=>(A("data-v-6eb6c80b"),e=e(),T(),e),R={class:"atTool",style:{padding:"10px"}},I={class:"content"},M={style:{padding:"10px 0"}},D=u(()=>i("label",null,"IMEI: ",-1)),N={style:{padding:"10px 0"}},B=u(()=>i("label",null,"SN: ",-1)),_={style:{display:"flex","flex-wrap":"wrap","align-items":"center",padding:"10px 0"}},E={for:"option1"},U=["value"],W=u(()=>i("br",null,null,-1)),L=u(()=>i("br",null,null,-1)),O={class:"right"};function V(e,t,s,o,l,n){return b(),v("div",R,[i("button",{onClick:t[0]||(t[0]=(...r)=>n.click&&n.click(...r))},"\u9009\u62E9\u7AEF\u53E3 "+w(l.isOpen?"\uFF08\u5DF2\u5F00\u542F\uFF09":"\uFF08\u672A\u5F00\u542F\uFF09"),1),d(i("div",I,[i("div",null,[i("button",{onClick:t[1]||(t[1]=r=>n.write("AT*PROD=1"))},"\u5DE5\u5382\u6A21\u5F0F"),i("button",{onClick:t[2]||(t[2]=r=>n.write("AT*PROD=0"))},"\u9000\u51FA\u5DE5\u5382\u6A21\u5F0F")]),i("div",M,[D,d(i("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>l.imei=r)},null,512),[[p,l.imei]]),i("button",{onClick:t[4]||(t[4]=r=>n.write("AT+CGSN"))},"\u8BFB\u53D6"),i("button",{onClick:t[5]||(t[5]=r=>n.write("AT*MRD_IMEI=D"))},"\u5220\u9664"),i("button",{onClick:t[6]||(t[6]=r=>n.write("AT*MRD_IMEI=W,0,01JAN1970,"+l.imei))},"\u5199\u5165")]),i("div",N,[B,d(i("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=r=>l.sn=r)},null,512),[[p,l.sn]]),i("button",{onClick:t[8]||(t[8]=r=>n.write("AT*MRD_SN?"))},"\u8BFB\u53D6"),i("button",{onClick:t[9]||(t[9]=r=>n.write("AT*MRD_SN=D"))},"\u5220\u9664"),i("button",{onClick:t[10]||(t[10]=r=>n.write("AT*MRD_SN=W,0,01JAN1970,"+l.sn))},"\u5199\u5165")]),i("div",null,[i("button",{onClick:t[11]||(t[11]=r=>n.write("AT+SWSIM=0"))},"\u5207\u5230\u53611"),i("button",{onClick:t[12]||(t[12]=r=>n.write("AT+SWSIM=1"))},"\u5207\u5230\u53612"),i("button",{onClick:t[13]||(t[13]=r=>n.write("AT+RESET"))},"\u91CD\u542F")]),i("div",_,[(b(!0),v(g,null,k(l.list,(r,a)=>(b(),v("span",{key:a,style:{display:"flex","flex-wrap":"wrap","align-items":"center",padding:"0 5px"}},[i("label",E,"LTE B"+w(r),1),d(i("input",{type:"checkbox",id:"option1",name:"options[]","onUpdate:modelValue":t[14]||(t[14]=h=>l.checked=h),value:r},null,8,U),[[S,l.checked,void 0,{number:!0}]]),W,L]))),128)),i("button",{onClick:t[15]||(t[15]=(...r)=>n.getBand&&n.getBand(...r))},"\u8BFB\u53D6\u9891\u6BB5"),i("button",{onClick:t[16]||(t[16]=(...r)=>n.submit&&n.submit(...r))},"\u9501\u5B9A\u9891\u6BB5")]),i("div",null,[d(i("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=r=>l.dataW=r),placeholder:"\u53D1\u9001\u81EA\u5B9A\u4E49AT\u6307\u4EE4"},null,512),[[p,l.dataW]]),i("button",{onClick:t[18]||(t[18]=r=>n.write())},"\u53D1\u9001")]),i("div",O,[d(i("textarea",{id:"scroll_text",cols:"30",rows:"10","onUpdate:modelValue":t[19]||(t[19]=r=>l.dataR=r),readonly:""},null,512),[[p,l.dataR]]),i("button",{onClick:t[20]||(t[20]=r=>l.dataR="")},"\u6E05\u7406")])],512),[[m,l.isOpen]])])}const q=f(y,[["render",V],["__scopeId","data-v-6eb6c80b"]]);export{q as default};
