import{c as n}from"./config.c00927f2.js";import w from"./list.169cd1ee.js";import{_ as k,r as u,a as y,o,c as l,b as c,F as f,e as p,f as _,k as S,w as L,t as C,i as x}from"./index.4c4a9a49.2022_10_27_03_16_14.js";const D={name:"keepAlive",components:{list:w},data(){return{dataSource:{},page:0,isLoading:!1}},computed:{v2sliderows(){let a=[];return this.dataSource.v2sliderows&&this.dataSource.v2sliderows.forEach(e=>{e.scene=="special.detail"&&a.push(e)}),a}},methods:{onRefresh(){this.loadData(1,this.$state)},itemClick(a){a.spid&&this.$router.push({path:"./detail?spid="+a.spid})},infinite(a){console.log("onReachBottom"),this.loadData(this.page+1,a)},loadData(a,e){console.log("config",n,n.query()),this.$axios.request({url:n.origin+"/special/listing-0-0-"+a,params:n.query()}).then(t=>{console.log("success",t),t.status==200&&t.data.retcode==0?(this.page=a,this.page==1?this.dataSource=t.data.data:(this.dataSource.actorrows=t.data.data.actorrows,this.dataSource.rows=this.dataSource.rows.concat(t.data.data.rows)),t.data.data.rows.length<16?e&&e.complete():e&&e.loaded()):(weui.topTips(t.data.errmsg||t.statusCode||"fail"),e.loaded())}).catch(t=>{e&&e.loaded(),weui.topTips(t.message||"fail")}).finally(()=>{this.isLoading=!1})}}},B={class:"special"},R={class:"header"},V=["onClick"],q={class:"image",mode:"aspectFill"},F={class:"title"},I={class:"content"};function z(a,e,t,E,i,r){const h=u("list"),m=u("van-pull-refresh"),g=u("infinite-loading"),v=y("lazy");return o(),l("div",B,[c("div",R,[(o(!0),l(f,null,p(i.dataSource.actorrows,(s,d)=>(o(),l("div",{class:"item",key:d,onClick:N=>r.itemClick(s)},[L(c("img",q,null,512),[[v,s.avatar]]),c("div",F,C(s.spname)+">",1)],8,V))),128))]),c("div",I,[_(m,{modelValue:i.isLoading,"onUpdate:modelValue":e[0]||(e[0]=s=>i.isLoading=s),onRefresh:r.onRefresh,style:{overflow:"inherit"}},{default:S(()=>[(o(!0),l(f,null,p(i.dataSource.rows,(s,d)=>(o(),x(h,{info:s,key:d,title:s.spname+" "+s.itemcount+"\u90E8",dataList:s.vodrows},null,8,["info","title","dataList"]))),128))]),_:1},8,["modelValue","onRefresh"]),_(g,{onInfinite:r.infinite,ref:"infiniteLoading"},null,8,["onInfinite"])])])}const U=k(D,[["render",z],["__scopeId","data-v-f47a95e1"]]);export{U as default};
