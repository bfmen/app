var v=Object.defineProperty,k=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var f=(e,t,i)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,p=(e,t)=>{for(var i in t||(t={}))_.call(t,i)&&f(e,i,t[i]);if(g)for(var i of g(t))C.call(t,i)&&f(e,i,t[i]);return e},d=(e,t)=>k(e,y(t));import{H as $}from"./es.array.splice.3bbf72af.js";import{m as D,n as w}from"./index.0b15903f.js";import"./array-method-has-species-support.4bbc7ede.js";var x=function(){var t=this,i=t.$createElement,l=t._self._c||i;return l("div",{staticClass:"home"},[l("div",{staticClass:"inputArea"},[l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u5E01\u79CD")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.currencys,callback:function(a){t.$set(t.config,"currencys",a)},expression:"config.currencys"}})],1),l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u5468\u671F")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.period,callback:function(a){t.$set(t.config,"period",a)},expression:"config.period"}})],1),l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u6570\u91CF")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.size,callback:function(a){t.$set(t.config,"size",a)},expression:"config.size"}})],1)]),l("div",{staticClass:"buttons"},[l("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.getData}},[t._v("\u83B7\u53D6\u6570\u636E")]),l("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.testClick()}}},[t._v(t._s(t.spotData.id||"\u83B7\u53D6\u8D26\u6237ID"))]),l("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.testClick2()}}},[t._v("\u6D4B\u8BD52")]),l("el-button",{attrs:{type:"danger"},on:{click:function(a){t.$store.state.klineData=[]}}},[t._v("\u5220\u9664\u7F51\u7EDC\u6570\u636E")])],1),l("div",{staticClass:"data"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[l("el-table-column",{attrs:{prop:"currency",label:"currency",width:"80"}}),l("el-table-column",{attrs:{prop:"period",label:"period",width:"80"}}),l("el-table-column",{attrs:{prop:"price",label:"price",width:"80"}}),l("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),l("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),l("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),l("el-table-column",{attrs:{prop:"length",label:"length"}}),l("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[l("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(c){return t.handleClick(a,1)}}},[t._v("\u8BA1\u7B97")]),l("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(c){return t.$store.state.klineData.splice(a.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),l("el-divider"),l("div",{staticClass:"inputArea"},[l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u6BCF\u7B14\u4EA4\u6613\u989D")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsSplit,callback:function(a){t.$set(t.config,"assetsSplit",a)},expression:"config.assetsSplit"}})],1),l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u9ED8\u8BA4U\u989D")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsAll,callback:function(a){t.$set(t.config,"assetsAll",a)},expression:"config.assetsAll"}})],1),l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u4EA4\u6613\u6761\u4EF6")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.riseKey,callback:function(a){t.$set(t.config,"riseKey",a)},expression:"config.riseKey"}})],1),l("div",{staticClass:"item"},[l("div",{staticClass:"title"},[t._v("\u71C3\u6599\u8D39")]),l("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.gas,callback:function(a){t.$set(t.config,"gas",a)},expression:"config.gas"}})],1)]),l("div",{staticClass:"buttons"},[l("el-button",{attrs:{type:"primary",loading:t.loading2},on:{click:function(a){return t.calculate(t.klineData)}}},[t._v("\u5F00\u59CB\u8BA1\u7B97")]),l("el-button",{attrs:{type:"danger"},on:{click:function(a){t.$store.state.calculateData=[]}}},[t._v("\u5220\u9664\u8BA1\u7B97\u6570\u636E")])],1),l("div",{staticClass:"data"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:t.calculateData,border:""}},[l("el-table-column",{attrs:{prop:"currency",label:"currency"}}),l("el-table-column",{attrs:{prop:"period",label:"period"}}),l("el-table-column",{attrs:{prop:"income",label:"income",sortable:"",width:"200"}}),l("el-table-column",{attrs:{prop:"fprice",label:"fprice"}}),l("el-table-column",{attrs:{prop:"price",label:"price"}}),l("el-table-column",{attrs:{prop:"length",label:"length"}}),l("el-table-column",{attrs:{prop:"assetsAll",label:"\u9ED8\u8BA4U\u989D"}}),l("el-table-column",{attrs:{prop:"numAll",label:"\u9ED8\u8BA4\u5E01\u6570"}}),l("el-table-column",{attrs:{prop:"assets",label:"assets"}}),l("el-table-column",{attrs:{prop:"num",label:"num"}}),l("el-table-column",{attrs:{prop:"all1",label:"all1"}}),l("el-table-column",{attrs:{prop:"all2",label:"all2"}}),l("el-table-column",{attrs:{prop:"all3",label:"all3"}}),l("el-table-column",{attrs:{prop:"buyCount",label:"buyCount"}}),l("el-table-column",{attrs:{prop:"sellCount",label:"sellCount"}}),l("el-table-column",{attrs:{prop:"buyError",label:"buyError"}}),l("el-table-column",{attrs:{prop:"sellError",label:"sellError"}}),l("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),l("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),l("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),l("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[l("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(c){return t.handleClick(a,2)}}},[t._v("\u8BA1\u7B97")]),l("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(c){return t.$store.state.calculateData.splice(a.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),l("el-divider")],1)},A=[];var h=window.axios;const F={name:"Home",components:{HelloWorld:$},data(){return{input:"",loading:!1,loading2:!1}},computed:d(p({},D({config:e=>e.config,urls:e=>e.urls,klineData:e=>e.klineData,calculateData:e=>e.calculateData,spotData:e=>e.accounts.filter(t=>t.type=="spot")[0]||{}})),{currencys(){return this.config.currencys.split(",")},periods(){return this.config.period.split(",")},tableData(){return this.klineData.map(e=>({currency:e.currency,period:e.period,price:e.price,length:e.list.length,start:o(e.list[0].id*1e3),end:o(e.list[e.list.length-1].id*1e3),time:o()}))}}),methods:{testClick(){let e=this.$util.huobiParams({},this.urls.accounts,"get");return console.log(e),new Promise((t,i)=>{h({method:"get",url:this.urls.accounts,params:e}).then(l=>{l.data["err-msg"]?console.log(l.data["err-msg"]):this.$store.state.accounts=l.data.data}).catch(l=>{b("\u9519\u8BEF:testCLick",l),t([])})})},testClick2(){let e=`https://api.huobi.pro/v1/account/accounts/${this.spotData.id}/balance`,t=this.$util.huobiParams({},e,"get");return console.log(t),new Promise((i,l)=>{h({method:"get",url:e,params:t}).then(s=>{if(s.data["err-msg"])console.log(s.data["err-msg"]);else{let r=s.data.data.list.filter(c=>["usdt","btc3l","btc3s"].includes(c.currency)&&c.type=="trade");console.log("arr",r)}}).catch(s=>{b("\u9519\u8BEF:testCLick",s),i([])})})},handleClick(e,t){t==1?this.$store.state.calculateData=[...this.calculate1([this.klineData[e.$index]]),...this.$store.state.calculateData]:t==2&&this.$store.state.calculateData.splice(e.$index,1,this.calculate1([this.calculateData[e.$index].item])[0])},getData(){let e=this.currencys,t=this.periods,i=[],l=[];e.forEach(s=>{t.forEach(a=>{i.push(S(s,a,this.config,this.urls.klineUrl)),l.push({currency:s,period:a,list:[],price:0})})}),console.log(e),console.log(t),this.loading=!0,Promise.all(i).then(s=>{this.loading=!1,s.forEach((a,r)=>{l[r].list=[...a].reverse(),l[r].price=l[r].list[0].close}),this.$store.state.klineData=[...l,...this.$store.state.klineData]}).catch(s=>{console.log(s)})},calculate(e){this.loading2=!0,this.$store.state.calculateData=[...this.calculate1(e),...this.$store.state.calculateData],this.loading2=!1},calculate1(e){return e.map(t=>this.calculate2(t))},calculate2(e){let t={buyCount:0,sellCount:0,buyError:0,sellError:0},i=parseFloat(this.config.assetsAll),l=parseFloat(this.config.assetsAll)/e.price,s=e.list;s.some((r,c)=>{let n=(r.close-r.open)/r.open;if(Math.abs(n)>parseFloat(this.config.riseKey)){let u=parseFloat(this.config.assetsSplit)/r.close;n>0?l>u?(i+=parseFloat(this.config.assetsSplit)*(1-parseFloat(this.config.gas)),l-=u,t.sellCount++):t.sellError++:i>parseFloat(this.config.assetsSplit)?(i-=parseFloat(this.config.assetsSplit),l+=u*(1-parseFloat(this.config.gas)),t.buyCount++):t.buyError++}});let a=d(p({currency:e.currency,period:e.period,fprice:e.list[0].close,price:e.list[e.list.length-1].close,length:e.list.length,all1:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/e.price*s[0].close,all2:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/e.price*s[s.length-1].close,all3:i+l*s[s.length-1].close,start:o(e.list[0].id*1e3),end:o(e.list[e.list.length-1].id*1e3),time:o(),assetsAll:this.config.assetsAll,numAll:parseFloat(this.config.assetsAll)/e.price,assets:i,num:l},t),{item:e});return a.income=a.all3-a.all1,a}}};function S(e,t,i,l){let s=i.size,a={symbol:(e+"usdt").toLowerCase(),period:t,size:s};return new Promise((r,c)=>{h({method:"get",url:l,params:a}).then(n=>{let u=n.data.data;r(u)}).catch(n=>{b("\u9519\u8BEF:GetRecords",n),r([])})})}function o(e){return window.dayjs(e).format("YYYY-MM-DD HH:mm:ss")}function b(){console.log(o(),...arguments)}const m={};var E=w(F,x,A,!1,z,null,null,null);function z(e){for(let t in m)this[t]=m[t]}var L=function(){return E.exports}();export{L as default};
