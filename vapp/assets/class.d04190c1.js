var p=Object.defineProperty,f=Object.defineProperties;var g=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;var n=(a,e,t)=>e in a?p(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,l=(a,e)=>{for(var t in e||(e={}))h.call(e,t)&&n(a,t,e[t]);if(d)for(var t of d(e))m.call(e,t)&&n(a,t,e[t]);return a},c=(a,e)=>f(a,g(e));import{c as s}from"./config.959b753b.js";import v from"./list.88ba7bc3.js";import y from"./tagSelect.fb9fc283.js";import{n as _}from"./index.aec38414.js";import"./array-method-has-species-support.f33995b6.js";var w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"class"},[e._l(e.tags,function(o,r){return i("tagSelect",{key:r,ref:"tagSelect".concat(r),refInFor:!0,attrs:{dataSource:o},on:{tagClick:function(C){return e.tagClick(r,arguments)}}})}),i("list",{attrs:{dataList:e.vodrows}}),e.dataSource.action?i("infinite-loading",{ref:"infiniteLoading",attrs:{identifier:e.identifier},on:{infinite:e.infinite}}):e._e()],2)},k=[];const q={components:{list:v,tagSelect:y},data(){return{page:0,identifier:0,vodrows:[],dataSource:{params:{},action:""},classList:[{key:"categories",query:"cateid",id:0},{key:"areas",query:"areaid",id:0},{key:"years",query:"yearid",id:0},{key:"definitions",query:"definition",id:0},{key:"durations",query:"duration",id:0},{key:"freetypes",query:"freetype",id:0},{key:"mosaics",query:"mosaic",id:0},{key:"langvoices",query:"langvoice",id:0},{key:"orders",query:"order",id:0}]}},computed:{tags(){let a=[];return this.classList.forEach(e=>{let t=this.dataSource[e.key];t&&a.push({items:[{id:0,title:"\u5168\u90E8"}].concat(t.map(i=>{let o=i.keyid||i.cateid||i.areaid||i.yearid;return c(l({},i),{id:o})})),id:e.id})}),a}},created(){this.loadBaseData()},methods:{tagClick(a,e){let t=0;e?t=e[0]:t=this.$refs["tagSelect"+a][0].idx,this.classList[a].id=this.tags[a].items[t].id},itemClick(a){a.spid&&uni.navigateTo({url:"./detail?spid="+a.spid})},infinite(a){console.log("onReachBottom"),this.loadPageData(this.page+1,a)},loadBaseData(){this.$axios.request({url:s.origin+"/vod/recommend",params:s.query()}).then(a=>{console.log("success",a),a.status==200&&a.data.retcode==0?this.dataSource=a.data.data:weui.topTips(a.data.errmsg||a.statusCode||"fail")}).catch(a=>{weui.topTips(a.message||"fail")})},loadPageData(a,e){this.$axios.request({url:s.origin+"/vod/listing-"+this.classList.map(t=>t.id).join("-")+"-"+this.page,params:s.query()}).then(t=>{console.log("success",t),t.status==200&&t.data.retcode==0?(this.page=a,this.page==1?this.vodrows=t.data.data.vodrows:this.vodrows=this.vodrows.concat(t.data.data.vodrows),t.data.data.vodrows.length<16?e&&e.complete():e&&e.loaded()):(weui.topTips(t.data.errmsg||t.statusCode||"fail"),e&&e.loaded())}).catch(t=>{e&&e.loaded(),weui.topTips(t.message||"fail")})}},watch:{classList:{deep:!0,handler(a){console.log("classList",a),this.page=0,this.vodrows=[],this.identifier=new Date().valueOf()}}}},u={};var x=_(q,w,k,!1,S,"2b8a5772",null,null);function S(a){for(let e in u)this[e]=u[e]}var E=function(){return x.exports}();export{E as default};
