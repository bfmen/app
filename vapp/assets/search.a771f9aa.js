import{c as r}from"./config.b0b2fcdf.js";import o from"./list.2bfb09d8.js";import{n as c}from"./index.b9647474.js";var l=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"special"},[i("div",{staticClass:"weui-search-bar",class:{"weui-search-bar_focusing":t.isTyping},attrs:{id:"searchBar"}},[i("form",{staticClass:"weui-search-bar__form",attrs:{\u03BFnsubmit:"return false;"}},[i("div",{staticClass:"weui-search-bar__box"},[i("i",{staticClass:"weui-icon-search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],ref:"searchInput",staticClass:"weui-search-bar__input",attrs:{type:"search",id:"searchInput",placeholder:"\u641C\u7D22",required:""},domProps:{value:t.inputText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),i("input",{staticStyle:{display:"none"}}),i("a",{staticClass:"weui-icon-clear",attrs:{href:"javascript:",id:"searchClear"},on:{click:function(e){t.inputText=""}}})]),i("label",{ref:"searchText",staticClass:"weui-search-bar__label",attrs:{id:"searchText"},on:{click:t.searchTextClick}},[i("i",{staticClass:"weui-icon-search"}),i("span",[t._v("\u641C\u7D22")])])]),i("a",{staticClass:"weui-search-bar__cancel-btn",attrs:{href:"javascript:",id:"searchCancel"},on:{click:function(e){t.isTyping=!1}}},[t._v("\u53D6\u6D88")])]),i("div",{staticClass:"items"},t._l(t.hotwords,function(e,s){return i("div",{key:s,staticClass:"item",on:{click:function(f){return t.itemClick(e)}}},[t._v(" "+t._s(e.dspwd)+" ")])}),0),i("list",{attrs:{dataList:t.vodrows.length>0?t.vodrows:t.hotrows}}),t.page>0?i("infinite-loading",{ref:"infiniteLoading",attrs:{identifier:t.identifier},on:{infinite:t.infinite}}):t._e()],1)},u=[];const d={name:"keepAlive",components:{list:o},data(){return{hotwords:[],hotrows:[],vodrows:[],page:0,inputText:"",isTyping:!1,identifier:""}},computed:{},created(){},mounted(){this.loadData(1)},methods:{searchTextClick(){this.isTyping=!0,this.$refs.searchInput.focus()},search(t){console.log("search",t),this.loadData(1)},itemClick(t){this.inputText=t.dspwd,this.isTyping=!0,this.loadData(1)},infinite(t){console.log("onReachBottom"),this.loadData(this.page+1,t)},loadData(t,a){console.log("config",r,r.query()),t===1&&(this.page=0,this.identifier=new Date().valueOf());let i=r.query();i.page=t,this.inputText&&(i.wd=this.inputText),this.$axios.request({url:r.origin+"/search",params:i}).then(e=>{if(console.log("success",e),e.status==200&&e.data.retcode==0){this.page=t,e.data.data.hotwords&&(this.hotwords=e.data.data.hotwords);let s=e.data.data.hotrows||e.data.data.vodrows;s?(this.page==1?this.vodrows=s:this.vodrows=this.vodrows.concat(s),s.length==0&&(weui.topTips("\u6CA1\u4E86"),a&&a.complete())):(weui.topTips("\u6CA1\u4E86"),a&&a.complete()),a&&a.loaded()}else weui.topTips(e.data.errmsg||e.statusCode||"fail")}).catch(e=>{a&&a.loaded(),weui.topTips(e.message||"fail")})}},watch:{inputText:{handler:function(t,a){},immediate:!1}}},n={};var h=c(d,l,u,!1,p,"f14ef39c",null,null);function p(t){for(let a in n)this[a]=n[a]}var w=function(){return h.exports}();export{w as default};
