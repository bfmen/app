import{c as a}from"./config.b0b2fcdf.js";import{n}from"./index.b9647474.js";var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"minVideo3",style:`min-height: ${e.minHeight};`},[i("div",{staticClass:"swiper"},[i("div",{staticClass:"swiper-wrapper"},e._l(e.rows,function(r,s){return i("div",{key:s,staticClass:"swiper-slide"},[e.mySwiper&&Math.abs(e.mySwiper.activeIndex-s)<=1?i("div",{staticStyle:{height:"100%"}},[Math.abs(e.mySwiper.activeIndex-s)<=1?i("video",{ref:"video",refInFor:!0,staticClass:"video",attrs:{id:r.vodrow.vodid,controls:"controls",playsinline:"",autoplay:e.mySwiper.activeIndex==s,width:"100%",src:r.videoUrl,poster:r.vodrow&&r.vodrow.coverpic}}):e._e()]):e._e()])}),0)]),i("div",{staticStyle:{"margin-left":"20px",position:"absolute",bottom:"20px",width:"calc(100% - 40px)","z-index":"100"}},[i("van-slider",{attrs:{max:e.rows.length-1,"inactive-color":"e0e0e0"},on:{change:e.onChange},scopedSlots:e._u([{key:"button",fn:function(){return[i("div",{staticClass:"custom-button"},[e._v(e._s(e.sliderValue))])]},proxy:!0}]),model:{value:e.sliderValue,callback:function(r){e.sliderValue=r},expression:"sliderValue"}})],1)])},d=[];const p={data(){return{sliderValue:0,minHeight:"100vh",mySwiper:null,rows:(()=>Array.from(Array(0)).map((e,t)=>({url:require(`@/assets/test/${t+1}.jpg`)})))()}},computed:{currentItem(){return this.rows.length?this.rows[this.mySwiper.activeIndex]:null}},watch:{"mySwiper.activeIndex":{handler:function(e){this.sliderValue=e,console.log("mySwiper",e),this.videoUrlUpdate(),e>=this.rows.length-2&&this.loadData(!1)}}},created(){this.minHeight=window.innerHeight+"px",this.loadData(!0)},mounted(){this.initSwiper()},methods:{loadImage(){},onChange(e){this.mySwiper.slideTo(e)},loadData(e){return this.$axios.request({url:a.origin+"/minivod/reqlist",params:a.query()}).then(t=>{if(console.log("success",t),t.status==200&&t.data.retcode==0){var i=[];t.data.data.rows.map(r=>{r.vodrow&&r.vodrow.vodid&&(r.videoUrl="",i.push(r))}),e?this.rows=i:this.rows.push(...i),this.$nextTick(()=>{this.mySwiper.updateSlides()})}else weui.topTips(t.data.errmsg||t.statusCode||"fail")}).catch(t=>{this.isMoreLoading=!1,weui.topTips(t.message||"fail")})},videoUrlUpdate(){this.$nextTick(()=>{this.$refs.video&&this.$refs.video.forEach(e=>{e.id==this.currentItem.vodrow.vodid?e.play():e.pause()})}),this.rows.filter((e,t)=>Math.abs(this.mySwiper.activeIndex-t)<=1).forEach(e=>{e.videoUrl||this.$axios.request({url:a.origin+e.vodrow.play_url,params:a.query()}).then(t=>{e.videoUrl=t.data.data.httpurl||t.data.data.httpurl_preview})})},initSwiper(){var e=new Swiper(".swiper",{loop:!1,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},scrollbar:{el:".swiper-scrollbar"}});this.mySwiper=Array.isArray(e)?e[e.length-1]:e}}},o={};var u=n(p,l,d,!1,c,"753729ba",null,null);function c(e){for(let t in o)this[t]=o[t]}var w=function(){return u.exports}();export{w as default};
