import{c as m}from"./config.959b753b.js";import{h as y,i as k,j as L,k as M,d as $,l as B,e as E,_ as T,b as j,m as C,n as N,p as U}from"./array-method-has-species-support.f33995b6.js";import{n as R}from"./index.aec38414.js";var S=y,A=L,F=k,z=S(S.bind),G=function(i,t){return A(i),t===void 0?i:F?z(i,t):function(){return i.apply(t,arguments)}},H=G,J=y,W=M,D=$,q=B,X=E,I=J([].push),r=function(i){var t=i==1,s=i==2,a=i==3,e=i==4,d=i==6,c=i==7,l=i==5||d;return function(p,w,b,O){for(var f=D(p),v=W(f),V=H(w,b),_=q(v),n=0,g=O||X,u=t?g(p,_):s||c?g(p,0):void 0,o,h;_>n;n++)if((l||n in v)&&(o=v[n],h=V(o,n,f),i))if(t)u[n]=h;else if(h)switch(i){case 3:return!0;case 5:return o;case 6:return n;case 2:I(u,o)}else switch(i){case 4:return!1;case 7:I(u,o)}return d?-1:a||e?e:u}},K={forEach:r(0),map:r(1),filter:r(2),some:r(3),every:r(4),find:r(5),findIndex:r(6),filterReject:r(7)},Q=T,Z=K.filter,P=j,Y=P("filter");Q({target:"Array",proto:!0,forced:!Y},{filter:function(t){return Z(this,t,arguments.length>1?arguments[1]:void 0)}});var tt=C,it=N,at=tt?{}.toString:function(){return"[object "+it(this)+"]"},et=C,st=U,rt=at;et||st(Object.prototype,"toString",rt,{unsafe:!0});var nt=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"list"},[t.title?a("div",{staticClass:"header",on:{click:t.headerClick}},[a("span",{staticClass:"title"},[t._v(t._s(t.title))]),a("span",{staticClass:"more"},[t._v("\u66F4\u591A")])]):t._e(),a("div",{staticClass:"numInfo"},[t._v(" "+t._s(this.dataList.filter(function(e){return e.isvip!=1}).length)+"/"+t._s(t.dataList.length)+" ")]),a("div",{staticClass:"items"},t._l(t.list,function(e,d){return a("div",{key:d+e.vodid,staticClass:"item",class:{itemMin:t.isMin},on:{click:function(l){return t.itemClick(e)}}},[t.vodid==e.vodid&&t.videoUrl?a("video",{ref:"video"+e.vodid,refInFor:!0,staticClass:"video bananaListVideo",class:{videoMin:t.isMin},attrs:{controls:"controls",playsinline:"",autoplay:"",title:e.title,poster:e.coverpic,"picture-in-picture-mode":["push","pop"],src:t.videoUrl}}):a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.coverpic,expression:"item.coverpic"}],staticClass:"image",class:{imagemMin:t.isMin},attrs:{mode:"aspectFit"},on:{load:function(l){return t.loadImage(e,l)}}}),a("span",[t._v(t._s(e.title||e.catename)+" "+t._s(t.showVideoState(e)))]),a("div",{staticClass:"tips"},[e.isvip==1?a("span",{staticClass:"isvip"},[t._v(t._s(e.isvip==1?"vip":""))]):t._e(),e.definition>0?a("span",{staticClass:"definition"},[t._v(t._s(e.definition))]):t._e(),t.isMin?t._e():a("span",{staticClass:"updatetime"},[t._v(t._s(e.updatetime))]),a("span",{staticClass:"upnum"},[t._v(t._s(e.upnum))]),a("span",{staticClass:"scorenum"},[t._v(t._s(e.scorenum))]),a("span",{staticClass:"duration"},[t._v(t._s(e.duration))])])])}),0)])},ot=[];const dt={props:{dataList:{default:()=>[]},info:{default:()=>({})},title:{default:""},isMin:{default:!1}},data(){return{vodid:"",videoUrl:"",loading:"",isLoading:!1}},computed:{list(){return this.dataList.filter(i=>this.$store.state.banana.isVipShow||i.isvip!=1)}},watch:{dataList(i){this.updateItem()}},methods:{updateItem(){this.dataList.forEach(i=>{i.url=this.gerBVInfo()[i.vodid]||i.url||"",i.intro=i.url})},headerClick(){this.info.spid?this.$router.push({path:"./detail?spid="+this.info.spid}):this.$router.push({path:"./class"})},showVideoState(i){let t=i.intro||i.url;return t?t===5?"vip":t.startsWith&&t.startsWith("http")?"ok":"..":".."},loadImage(i,t){let s=t.path[0];s.src&&s.src.startsWith("http")&&this.itemClick(i,!0)},setBVInfo(i,t){let s=t.data.data.httpurl||t.data.data.httpurl_preview||t.data.retcode,a={};try{a=JSON.parse(localStorage.BVInfo)}catch{}a[i.vodid]=s,i.url=s,i.intro=s,localStorage.BVInfo=JSON.stringify(a),this.updateItem()},gerBVInfo(){try{return JSON.parse(localStorage.BVInfo)}catch{return{}}},itemClick(i,t){let s=i.url;if(s&&String(s).startsWith("http")){t||(this.videoUrl=s,this.vodid=i.vodid,this.hideOtherVideo(),document&&(document.title=i.title));return}else if(s){t||weui.topTips(s);return}t||(this.loading&&this.loading.hide(),this.loading=weui.loading()),i.vodid!=this.vodid&&(this.isLoading=!0,this.$axios({url:m.origin+i.play_url,params:m.query()}).then(a=>{this.isLoading=!1,this.setBVInfo(i,a),t||(this.loading&&this.loading.hide(),console.log("success",a),a.data.data.httpurl?(this.videoUrl=a.data.data.httpurl,this.vodid=i.vodid,this.hideOtherVideo()):a.data.data.httpurl_preview?(this.videoUrl=a.data.data.httpurl_preview,this.vodid=i.vodid,this.hideOtherVideo()):weui.topTips(a.data.errmsg||"fail"),document&&(document.title=i.title))}).catch(a=>{t||(this.loading&&this.loading.hide(),weui.topTips(a.message||"fail"))}))},hideOtherVideo(){setTimeout(()=>{this.$refs["video"+this.vodid][0].play();let i=new Array(...document.querySelectorAll(".bananaListVideo")).filter(t=>t.src!=this.videoUrl).forEach(t=>{t.pause(),t.parentElement.parentElement.parentElement.__vue__.vodid="",t.parentElement.parentElement.parentElement.__vue__.videoUrl=""});console.log(i)})}},destroyed(){this.loading&&this.loading.hide()}},x={};var lt=R(dt,nt,ot,!1,ut,"18917a93",null,null);function ut(i){for(let t in x)this[t]=x[t]}var ht=function(){return lt.exports}();export{ht as default};
