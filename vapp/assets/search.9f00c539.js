import{c as r}from"./config.959b753b.js";import o from"./list.d65320fd.js";import{n as c}from"./index.4878a097.js";var l=function(){var e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"special"},[i("div",{staticClass:"weui-search-bar",class:{"weui-search-bar_focusing":e.isTyping},attrs:{id:"searchBar"}},[i("form",{staticClass:"weui-search-bar__form",attrs:{\u03BFnsubmit:"return false;"}},[i("div",{staticClass:"weui-search-bar__box"},[i("i",{staticClass:"weui-icon-search"}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.inputText,expression:"inputText"}],ref:"searchInput",staticClass:"weui-search-bar__input",attrs:{type:"search",id:"searchInput",placeholder:"\u641C\u7D22",required:""},domProps:{value:e.inputText},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},input:function(t){t.target.composing||(e.inputText=t.target.value)}}}),i("input",{staticStyle:{display:"none"}}),i("a",{staticClass:"weui-icon-clear",attrs:{href:"javascript:",id:"searchClear"},on:{click:function(t){e.inputText=""}}})]),i("label",{ref:"searchText",staticClass:"weui-search-bar__label",attrs:{id:"searchText"},on:{click:e.searchTextClick}},[i("i",{staticClass:"weui-icon-search"}),i("span",[e._v("\u641C\u7D22")])])]),i("a",{staticClass:"weui-search-bar__cancel-btn",attrs:{href:"javascript:",id:"searchCancel"},on:{click:function(t){e.isTyping=!1}}},[e._v("\u53D6\u6D88")])]),i("div",{staticClass:"items"},e._l(e.hotwords,function(t,s){return i("div",{key:s,staticClass:"item",on:{click:function(h){return e.itemClick(t)}}},[e._v(" "+e._s(t.dspwd)+" ")])}),0),i("list",{attrs:{dataList:e.vodrows.length>0?e.vodrows:e.hotrows}}),e.page>0?i("infinite-loading",{ref:"infiniteLoading",attrs:{identifier:e.identifier},on:{infinite:e.infinite}}):e._e()],1)},d=[];const p={name:"keepAlive",components:{list:o},data(){return{hotwords:[],hotrows:[],vodrows:[],page:0,inputText:"",isTyping:!1,identifier:""}},computed:{},created(){},mounted(){this.loadData(1)},methods:{searchTextClick(){this.isTyping=!0,this.$refs.searchInput.focus()},search(e){console.log("search",e),this.loadData(1)},itemClick(e){this.inputText=e.dspwd,this.isTyping=!0,this.loadData(1)},infinite(e){console.log("onReachBottom"),this.loadData(this.page+1,e)},loadData(e,a){console.log("config",r,r.query()),e===1&&(this.page=0,this.identifier=new Date().valueOf());let i=r.query();i.page=e,this.inputText&&(i.wd=this.inputText),this.$axios.request({url:r.origin+"/search",params:i}).then(t=>{if(console.log("success",t),t.status==200&&t.data.retcode==0){this.page=e,t.data.data.hotwords&&(this.hotwords=t.data.data.hotwords);let s=t.data.data.hotrows||t.data.data.vodrows;s?(this.page==1?this.vodrows=s:this.vodrows=this.vodrows.concat(s),s.length==0&&(weui.topTips("\u6CA1\u4E86"),a&&a.complete())):(weui.topTips("\u6CA1\u4E86"),a&&a.complete()),a&&a.loaded()}else weui.topTips(t.data.errmsg||t.statusCode||"fail")}).catch(t=>{a&&a.loaded(),weui.topTips(t.message||"fail")})}},watch:{inputText:{handler:function(e,a){},immediate:!1}}},n={};var u=c(p,l,d,!1,f,"f14ef39c",null,null);function f(e){for(let a in n)this[a]=n[a]}var w=function(){return u.exports}();export{w as default};
