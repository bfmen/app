import{c as o}from"./config.73be10ef.js";import{n}from"./index.93f39628.js";var u=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"list"},[t.title?s("div",{staticClass:"header",on:{click:t.headerClick}},[s("span",{staticClass:"title"},[t._v(t._s(t.title))]),s("span",{staticClass:"more"},[t._v("\u66F4\u591A")])]):t._e(),s("div",{staticClass:"numInfo"},[t._v(" "+t._s(this.dataList.filter(function(a){return a.play_url_data?[".m3u8",".mp4"].some(function(e){return JSON.stringify(a.play_url_data).includes(e)}):a.isvip!=1}).length)+"/"+t._s(t.dataList.length)+" ")]),s("div",{staticClass:"items"},t._l(t.list,function(a,e){return s("div",{key:e+a.vodid,staticClass:"item",class:{itemMin:t.isMin},on:{click:function(r){return t.itemClick(a)}}},[t.vodid==a.vodid&&t.videoUrl?s("video",{ref:"video"+a.vodid,refInFor:!0,staticClass:"video bananaListVideo",class:{videoMin:t.isMin},attrs:{controls:"controls",playsinline:"",autoplay:"",title:a.title,poster:a.coverpic,"picture-in-picture-mode":["push","pop"],src:t.videoUrl}}):s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.coverpic,expression:"item.coverpic"}],staticClass:"image",class:{imagemMin:t.isMin},attrs:{mode:"aspectFit"},on:{load:function(r){return t.loadImage(a,r)}}}),s("span",[t._v(t._s(a.title||a.catename)+" "+t._s(t.showVideoState(a)))]),s("div",{staticClass:"tips"},[a.isvip==1||a.play_url_data&&a.play_url_data.errmsg&&a.play_url_data.retcode!=5?s("span",{staticClass:"isvip"},[t._v(t._s(a.play_url_data&&a.play_url_data.errmsg&&a.play_url_data.retcode!=3?a.play_url_data.errmsg:a.isvip==1?"vip":""))]):t._e(),a.definition>0&&!t.showKey?s("span",{staticClass:"definition"},[t._v(t._s(a.definition))]):t._e(),!t.isMin&&!t.showKey?s("span",{staticClass:"updatetime"},[t._v(t._s(a.updatetime))]):t._e(),t.showKey?t._e():s("span",{staticClass:"upnum"},[t._v(t._s(a.upnum))]),t.showKey?t._e():s("span",{staticClass:"scorenum"},[t._v(t._s(a.scorenum))]),t.showKey?t._e():s("span",{staticClass:"duration"},[t._v(t._s(a.duration))]),t.showKey&&a.retcode_v==3?s("span",{staticClass:"duration"},[t._v(t._s("\u9884\u89C8"))]):t._e(),t.showKey?s("span",{staticClass:"duration"},[t._v(t._s(a[t.showKey]))]):t._e()])])}),0)])},c=[];const h={props:{dataList:{default:()=>[]},info:{default:()=>({})},title:{default:""},isMin:{default:!1},showKey:{default:""}},data(){return{vodid:"",videoUrl:"",loading:"",isLoading:!1}},computed:{list(){return this.dataList.filter(t=>this.$store.state.banana.isVipShow||(t.play_url_data?[".m3u8",".mp4"].some(i=>JSON.stringify(t.play_url_data).includes(i)):t.isvip!=1))}},watch:{dataList(t){this.updateItem()}},methods:{updateItem(){this.dataList.forEach(t=>{t.url=this.gerBVInfo()[t.vodid]||t.url||"",t.intro=t.url})},headerClick(){this.info.spid?this.$router.push({path:"./detail?spid="+this.info.spid}):this.$router.push({path:"./class"})},showVideoState(t){let i=t.intro||t.url;return i?i===5?"vip":i.startsWith&&i.startsWith("http")?"ok":"..":".."},loadImage(t,i){let s=i.target||i.path[0];s.src&&s.src.startsWith("http")&&this.itemClick(t,!0)},setBVInfo(t,i){let s=i.data.data.httpurl||i.data.data.httpurl_preview||i.data.retcode,a={};try{a=JSON.parse(localStorage.BVInfo)}catch{}a[t.vodid]=s,t.url=s,t.intro=s,localStorage.BVInfo=JSON.stringify(a),this.updateItem()},gerBVInfo(){try{return JSON.parse(localStorage.BVInfo)}catch{return{}}},itemClick(t,i){let s=t.url;if(s&&String(s).startsWith("http")){i||(this.videoUrl=s,this.vodid=t.vodid,this.hideOtherVideo(),document&&(document.title=t.title));return}else if(s){i||this.$toast(t.play_url_data?t.play_url_data.errmsg:s);return}i||(this.loading&&this.loading.hide(),this.loading=weui.loading()),t.vodid!=this.vodid&&(this.isLoading=!0,this.$axios({url:o.origin+t.play_url,params:o.query()}).then(a=>{this.isLoading=!1,this.setBVInfo(t,a),i||(this.loading&&this.loading.hide(),console.log("success",a),a.data.data.httpurl?(this.videoUrl=a.data.data.httpurl,this.vodid=t.vodid,this.hideOtherVideo()):a.data.data.httpurl_preview?(this.videoUrl=a.data.data.httpurl_preview,this.vodid=t.vodid,this.hideOtherVideo()):this.$toast(a.data.errmsg||"fail"),document&&(document.title=t.title),this.videoUrl&&l(this.videoUrl))}).catch(a=>{i||(this.loading&&this.loading.hide(),this.$toast(a.message||"fail"))})),this.videoUrl&&l(this.videoUrl)},hideOtherVideo(){setTimeout(()=>{this.$refs["video"+this.vodid][0].play();let t=new Array(...document.querySelectorAll(".bananaListVideo")).filter(i=>i.src!=this.videoUrl).forEach(i=>{i.pause(),i.parentElement.parentElement.parentElement.__vue__.vodid="",i.parentElement.parentElement.parentElement.__vue__.videoUrl=""});console.log(t)})}},destroyed(){this.loading&&this.loading.hide()}};function l(t){var i=document.createElement("input");i.value=t,document.body.appendChild(i),i.select(),document.execCommand("Copy"),i.remove(),console.log("copy")}const d={};var p=n(h,u,c,!1,_,"db99451e",null,null);function _(t){for(let i in d)this[i]=d[i]}var g=function(){return p.exports}();export{g as default};
