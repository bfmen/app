import{c as o}from"./config.3d405634.js";import{n as l}from"./index.6aa3385c.js";var d=function(){var e=this,a=e.$createElement,i=e._self._c||a;return i("div",{staticClass:"minVideo3",style:"min-height: ".concat(e.minHeight,";")},[i("div",{staticClass:"swiper"},[i("div",{staticClass:"swiper-wrapper"},e._l(e.rows,function(r,s){return i("div",{key:s,staticClass:"swiper-slide"},[e.mySwiper&&Math.abs(e.mySwiper.activeIndex-s)<=1?i("div",{staticStyle:{height:"100%"}},[Math.abs(e.mySwiper.activeIndex-s)<=1?i("video",{ref:"video",refInFor:!0,staticClass:"video",attrs:{id:r.vodrow.vodid,controls:"controls",playsinline:"",autoplay:e.mySwiper.activeIndex==s,width:"100%",src:r.videoUrl,poster:r.vodrow&&r.vodrow.coverpic}}):e._e()]):e._e()])}),0)]),i("div",{staticStyle:{"margin-left":"20px",position:"absolute",bottom:"20px",width:"calc(100% - 40px)","z-index":"100"}},[i("van-slider",{attrs:{max:e.rows.length-1,"inactive-color":"e0e0e0"},on:{change:e.onChange},scopedSlots:e._u([{key:"button",fn:function(){return[i("div",{staticClass:"custom-button"},[e._v(e._s(e.sliderValue))])]},proxy:!0}]),model:{value:e.sliderValue,callback:function(s){e.sliderValue=s},expression:"sliderValue"}})],1)])},p=[];const c={data(){return{sliderValue:0,minHeight:"100vh",mySwiper:null,rows:(()=>Array.from(Array(0)).map((t,e)=>({url:require(`@/assets/test/${e+1}.jpg`)})))()}},computed:{currentItem(){return this.rows.length?this.rows[this.mySwiper.activeIndex]:null}},watch:{"mySwiper.activeIndex":{handler:function(t){this.sliderValue=t,console.log("mySwiper",t),this.videoUrlUpdate(),t>=this.rows.length-2&&this.loadData(!1)}}},created(){this.minHeight=window.innerHeight+"px",this.loadData(!0)},mounted(){this.initSwiper()},methods:{loadImage(){},onChange(t){this.mySwiper.slideTo(t)},loadData(t){return this.$axios.request({url:o.origin+"/minivod/reqlist",params:o.query()}).then(e=>{if(console.log("success",e),e.status==200&&e.data.retcode==0){var a=[];e.data.data.rows.map(i=>{i.vodrow&&i.vodrow.vodid&&(i.videoUrl="",a.push(i))}),t?this.rows=a:this.rows.push(...a),this.$nextTick(()=>{this.mySwiper.updateSlides()})}else weui.topTips(e.data.errmsg||e.statusCode||"fail")}).catch(e=>{this.isMoreLoading=!1,weui.topTips(e.message||"fail")})},videoUrlUpdate(){this.$nextTick(()=>{this.$refs.video&&this.$refs.video.forEach(t=>{t.id==this.currentItem.vodrow.vodid?t.play():t.pause()})}),this.rows.filter((t,e)=>Math.abs(this.mySwiper.activeIndex-e)<=1).forEach(t=>{t.videoUrl||this.$axios.request({url:o.origin+t.vodrow.play_url,params:o.query()}).then(e=>{t.videoUrl=e.data.data.httpurl||e.data.data.httpurl_preview})})},initSwiper(){var t=new Swiper(".swiper",{loop:!1,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},scrollbar:{el:".swiper-scrollbar"}});this.mySwiper=Array.isArray(t)?t[t.length-1]:t}}},n={};var u=l(c,d,p,!1,h,"753729ba",null,null);function h(t){for(let e in n)this[e]=n[e]}var m=function(){return u.exports}();export{m as default};
