import{H as g}from"./HelloWorld.6c42e73d.js";import{m as f,n as m}from"./index.4df44388.js";var b=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"home"},[e("div",{staticClass:"inputArea"},[e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u5E01\u79CD")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.currencys,callback:function(l){t.$set(t.config,"currencys",l)},expression:"config.currencys"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u5468\u671F")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.period,callback:function(l){t.$set(t.config,"period",l)},expression:"config.period"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u6570\u91CF")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.size,callback:function(l){t.$set(t.config,"size",l)},expression:"config.size"}})],1)]),e("div",{staticClass:"buttons"},[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.getData}},[t._v("\u83B7\u53D6\u6570\u636E")]),e("el-button",{attrs:{type:"primary"},on:{click:function(l){return t.testClick()}}},[t._v(t._s(t.spotData.id||"\u83B7\u53D6\u8D26\u6237ID"))]),e("el-button",{attrs:{type:"primary"},on:{click:function(l){return t.testClick2()}}},[t._v("\u6D4B\u8BD52")]),e("el-button",{attrs:{type:"danger"},on:{click:function(l){t.$store.state.klineData=[]}}},[t._v("\u5220\u9664\u7F51\u7EDC\u6570\u636E")])],1),e("div",{staticClass:"data"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"currency",label:"currency",width:"80"}}),e("el-table-column",{attrs:{prop:"period",label:"period",width:"80"}}),e("el-table-column",{attrs:{prop:"price",label:"price",width:"80"}}),e("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),e("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),e("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),e("el-table-column",{attrs:{prop:"length",label:"length"}}),e("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.handleClick(l,1)}}},[t._v("\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return t.$store.state.klineData.splice(l.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),e("el-divider"),e("div",{staticClass:"inputArea"},[e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u6BCF\u7B14\u4EA4\u6613\u989D")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsSplit,callback:function(l){t.$set(t.config,"assetsSplit",l)},expression:"config.assetsSplit"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u9ED8\u8BA4U\u989D")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsAll,callback:function(l){t.$set(t.config,"assetsAll",l)},expression:"config.assetsAll"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u4EA4\u6613\u6761\u4EF6")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.riseKey,callback:function(l){t.$set(t.config,"riseKey",l)},expression:"config.riseKey"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u71C3\u6599\u8D39")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.gas,callback:function(l){t.$set(t.config,"gas",l)},expression:"config.gas"}})],1)]),e("div",{staticClass:"buttons"},[e("el-button",{attrs:{type:"primary",loading:t.loading2},on:{click:function(l){return t.calculate(t.klineData)}}},[t._v("\u5F00\u59CB\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger"},on:{click:function(l){t.$store.state.calculateData=[]}}},[t._v("\u5220\u9664\u8BA1\u7B97\u6570\u636E")])],1),e("div",{staticClass:"data"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:t.calculateData,border:""}},[e("el-table-column",{attrs:{prop:"currency",label:"currency"}}),e("el-table-column",{attrs:{prop:"period",label:"period"}}),e("el-table-column",{attrs:{prop:"income",label:"income",sortable:"",width:"200"}}),e("el-table-column",{attrs:{prop:"fprice",label:"fprice"}}),e("el-table-column",{attrs:{prop:"price",label:"price"}}),e("el-table-column",{attrs:{prop:"length",label:"length"}}),e("el-table-column",{attrs:{prop:"assetsAll",label:"\u9ED8\u8BA4U\u989D"}}),e("el-table-column",{attrs:{prop:"numAll",label:"\u9ED8\u8BA4\u5E01\u6570"}}),e("el-table-column",{attrs:{prop:"assets",label:"assets"}}),e("el-table-column",{attrs:{prop:"num",label:"num"}}),e("el-table-column",{attrs:{prop:"all1",label:"all1"}}),e("el-table-column",{attrs:{prop:"all2",label:"all2"}}),e("el-table-column",{attrs:{prop:"all3",label:"all3"}}),e("el-table-column",{attrs:{prop:"buyCount",label:"buyCount"}}),e("el-table-column",{attrs:{prop:"sellCount",label:"sellCount"}}),e("el-table-column",{attrs:{prop:"buyError",label:"buyError"}}),e("el-table-column",{attrs:{prop:"sellError",label:"sellError"}}),e("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),e("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),e("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),e("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(l){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.handleClick(l,2)}}},[t._v("\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return t.$store.state.calculateData.splice(l.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),e("el-divider")],1)},v=[];var p=window.axios;const y={name:"Home",components:{HelloWorld:g},data(){return{input:"",loading:!1,loading2:!1}},computed:{...f({config:t=>t.config,urls:t=>t.urls,klineData:t=>t.klineData,calculateData:t=>t.calculateData,spotData:t=>t.accounts.filter(a=>a.type=="spot")[0]||{}}),currencys(){return this.config.currencys.split(",")},periods(){return this.config.period.split(",")},tableData(){return this.klineData.map(t=>({currency:t.currency,period:t.period,price:t.price,length:t.list.length,start:o(t.list[0].id*1e3),end:o(t.list[t.list.length-1].id*1e3),time:o()}))}},methods:{testClick(){let t=this.$util.huobiParams({},this.urls.accounts,"get");return console.log(t),new Promise((a,e)=>{p({method:"get",url:this.urls.accounts,params:t}).then(l=>{l.data["err-msg"]?console.log(l.data["err-msg"]):this.$store.state.accounts=l.data.data}).catch(l=>{d("\u9519\u8BEF:testCLick",l),a([])})})},testClick2(){let t=`https://api.huobi.pro/v1/account/accounts/${this.spotData.id}/balance`,a=this.$util.huobiParams({},t,"get");return console.log(a),new Promise((e,l)=>{p({method:"get",url:t,params:a}).then(s=>{if(s.data["err-msg"])console.log(s.data["err-msg"]);else{let i=s.data.data.list.filter(u=>["usdt","btc3l","btc3s"].includes(u.currency)&&u.type=="trade");console.log("arr",i)}}).catch(s=>{d("\u9519\u8BEF:testCLick",s),e([])})})},handleClick(t,a){a==1?this.$store.state.calculateData=[...this.calculate1([this.klineData[t.$index]]),...this.$store.state.calculateData]:a==2&&this.$store.state.calculateData.splice(t.$index,1,this.calculate1([this.calculateData[t.$index].item])[0])},getData(){let t=this.currencys,a=this.periods,e=[],l=[];t.forEach(s=>{a.forEach(r=>{e.push(_(s,r,this.config,this.urls.klineUrl)),l.push({currency:s,period:r,list:[],price:0})})}),console.log(t),console.log(a),this.loading=!0,Promise.all(e).then(s=>{this.loading=!1,s.forEach((r,i)=>{l[i].list=[...r].reverse(),l[i].price=l[i].list[0].close}),this.$store.state.klineData=[...l,...this.$store.state.klineData]}).catch(s=>{console.log(s)})},calculate(t){this.loading2=!0,this.$store.state.calculateData=[...this.calculate1(t),...this.$store.state.calculateData],this.loading2=!1},calculate1(t){return t.map(a=>this.calculate2(a))},calculate2(t){let a={buyCount:0,sellCount:0,buyError:0,sellError:0},e=parseFloat(this.config.assetsAll),l=parseFloat(this.config.assetsAll)/t.price,s=t.list;s.some((i,u)=>{let n=(i.close-i.open)/i.open;if(Math.abs(n)>parseFloat(this.config.riseKey)){let c=parseFloat(this.config.assetsSplit)/i.close;n>0?l>c?(e+=parseFloat(this.config.assetsSplit)*(1-parseFloat(this.config.gas)),l-=c,a.sellCount++):a.sellError++:e>parseFloat(this.config.assetsSplit)?(e-=parseFloat(this.config.assetsSplit),l+=c*(1-parseFloat(this.config.gas)),a.buyCount++):a.buyError++}});let r={currency:t.currency,period:t.period,fprice:t.list[0].close,price:t.list[t.list.length-1].close,length:t.list.length,all1:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/t.price*s[0].close,all2:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/t.price*s[s.length-1].close,all3:e+l*s[s.length-1].close,start:o(t.list[0].id*1e3),end:o(t.list[t.list.length-1].id*1e3),time:o(),assetsAll:this.config.assetsAll,numAll:parseFloat(this.config.assetsAll)/t.price,assets:e,num:l,...a,item:t};return r.income=r.all3-r.all1,r}}};function _(t,a,e,l){let s=e.size,r={symbol:(t+"usdt").toLowerCase(),period:a,size:s};return new Promise((i,u)=>{p({method:"get",url:l,params:r}).then(n=>{let c=n.data.data;i(c)}).catch(n=>{d("\u9519\u8BEF:GetRecords",n),i([])})})}function o(t){return window.dayjs(t).format("YYYY-MM-DD HH:mm:ss")}function d(){console.log(o(),...arguments)}const h={};var k=m(y,b,v,!1,C,null,null,null);function C(t){for(let a in h)this[a]=h[a]}var x=function(){return k.exports}();export{x as default};
