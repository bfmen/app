import{c as S}from"./config.3d405634.js";import{h as y,i as B,j as L,k as M,b as k,l as T,d as x,_ as E,a as N,m as V,n as U,p as R}from"./array-method-has-species-support.1664140e.js";import{n as j}from"./index.e11420c8.js";var m=y,A=L,F=B,G=m(m.bind),H=function(e,t){return A(e),t===void 0?e:F?G(e,t):function(){return e.apply(t,arguments)}},J=H,z=y,D=M,q=k,W=T,X=x,I=z([].push),s=function(e){var t=e==1,r=e==2,i=e==3,a=e==4,l=e==6,u=e==7,d=e==5||l;return function(v,O,b,$){for(var h=q(v),p=D(h),w=J(O,b),_=W(p),n=0,g=$||X,c=t?g(v,_):r||u?g(v,0):void 0,o,f;_>n;n++)if((d||n in p)&&(o=p[n],f=w(o,n,h),e))if(t)c[n]=f;else if(f)switch(e){case 3:return!0;case 5:return o;case 6:return n;case 2:I(c,o)}else switch(e){case 4:return!1;case 7:I(c,o)}return l?-1:i||a?a:c}},K={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)},Q=E,Z=K.filter,P=N,Y=P("filter");Q({target:"Array",proto:!0,forced:!Y},{filter:function(t){return Z(this,t,arguments.length>1?arguments[1]:void 0)}});var tt=V,et=U,it=tt?{}.toString:function(){return"[object "+et(this)+"]"},at=V,rt=R,st=it;at||rt(Object.prototype,"toString",st,{unsafe:!0});var nt=function(){var t=this,r=t.$createElement,i=t._self._c||r;return i("div",{staticClass:"list"},[t.title?i("div",{staticClass:"header",on:{click:t.headerClick}},[i("span",{staticClass:"title"},[t._v(t._s(t.title))]),i("span",{staticClass:"more"},[t._v("\u66F4\u591A")])]):t._e(),i("div",{staticClass:"numInfo"},[t._v(" "+t._s(this.dataList.filter(function(a){return a.isvip!=1}).length)+"/"+t._s(t.dataList.length)+" ")]),i("div",{staticClass:"items"},t._l(t.list,function(a,l){return i("div",{key:l+a.vodid,staticClass:"item",class:{itemMin:t.isMin},on:{click:function(d){return t.itemClick(a)}}},[t.vodid==a.vodid&&t.videoUrl?i("video",{ref:"video"+a.vodid,refInFor:!0,staticClass:"video bananaListVideo",class:{videoMin:t.isMin},attrs:{controls:"controls",playsinline:"",autoplay:"",title:a.title,poster:a.coverpic,"picture-in-picture-mode":["push","pop"],src:t.videoUrl}}):i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.coverpic,expression:"item.coverpic"}],staticClass:"image",class:{imagemMin:t.isMin},attrs:{mode:"aspectFit"},on:{load:function(d){return t.loadImage(a,d)}}}),i("span",[t._v(t._s(a.title||a.catename)+" "+t._s(t.showVideoState(a)))]),i("div",{staticClass:"tips"},[a.isvip==1?i("span",{staticClass:"isvip"},[t._v(t._s(a.isvip==1?"vip":""))]):t._e(),a.definition>0?i("span",{staticClass:"definition"},[t._v(t._s(a.definition))]):t._e(),t.isMin?t._e():i("span",{staticClass:"updatetime"},[t._v(t._s(a.updatetime))]),i("span",{staticClass:"upnum"},[t._v(t._s(a.upnum))]),i("span",{staticClass:"scorenum"},[t._v(t._s(a.scorenum))]),i("span",{staticClass:"duration"},[t._v(t._s(a.duration))])])])}),0)])},ot=[];const lt={props:{dataList:{default:()=>[]},info:{default:()=>({})},title:{default:""},isMin:{default:!1}},data(){return{vodid:"",videoUrl:"",loading:"",isLoading:!1}},computed:{list(){return this.dataList.filter(e=>this.$store.state.banana.isVipShow||e.isvip!=1)}},methods:{headerClick(){this.info.spid?this.$router.push({path:"./detail?spid="+this.info.spid}):this.$router.push({path:"./class"})},showVideoState(e){let t=this.getBVInfo(e);return t?t===5?"vip":"ok":"..."},loadImage(e,t){let r=t.path[0];r.src&&r.src.startsWith("http")&&this.itemClick(e,!0)},setBVInfo(e,t){let r=t.data.data.httpurl||t.data.data.httpurl_preview||t.data.retcode,i={};try{i=JSON.parse(localStorage.BVInfo)}catch{}i[e.vodid]=r,localStorage.BVInfo=JSON.stringify(i)},getBVInfo(e){try{return JSON.parse(localStorage.BVInfo)[e.vodid]}catch{return!1}},itemClick(e,t){let r=this.getBVInfo(e);if(r&&String(r).startsWith("http")){t||(this.videoUrl=r,this.vodid=e.vodid,this.hideOtherVideo());return}else if(r){t||weui.topTips(r);return}t||(this.loading&&this.loading.hide(),this.loading=weui.loading()),e.vodid!=this.vodid&&(this.isLoading=!0,this.$axios({url:S.origin+e.play_url,params:S.query()}).then(i=>{this.isLoading=!1,this.setBVInfo(e,i),t||(this.loading.hide(),console.log("success",i),i.data.data.httpurl?(this.videoUrl=i.data.data.httpurl,this.vodid=e.vodid,this.hideOtherVideo()):i.data.data.httpurl_preview?(this.videoUrl=i.data.data.httpurl_preview,this.vodid=e.vodid,this.hideOtherVideo()):weui.topTips(i.data.errmsg||"fail"),document&&(document.title=e.title))}).catch(i=>{t||weui.topTips(i.message||"fail")}))},hideOtherVideo(){setTimeout(()=>{this.$refs["video"+this.vodid][0].play();let e=new Array(...document.querySelectorAll(".bananaListVideo")).filter(t=>t.src!=this.videoUrl).forEach(t=>{t.pause(),t.parentElement.parentElement.parentElement.__vue__.vodid="",t.parentElement.parentElement.parentElement.__vue__.videoUrl=""});console.log(e)})}}},C={};var dt=j(lt,nt,ot,!1,ct,"59653108",null,null);function ct(e){for(let t in C)this[t]=C[t]}var ft=function(){return dt.exports}();export{ft as default};
