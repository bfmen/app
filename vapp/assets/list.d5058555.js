import{c as o}from"./config.162a1bb4.js";import{n}from"./index.d4f7d709.js";var l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"list"},[t.title?e("div",{staticClass:"header",on:{click:t.headerClick}},[e("span",{staticClass:"title"},[t._v(t._s(t.title))]),e("span",{staticClass:"more"},[t._v("\u66F4\u591A")])]):t._e(),e("div",{staticClass:"numInfo"},[t._v(" "+t._s(this.dataList.filter(function(i){return i.isvip!=1}).length)+"/"+t._s(t.dataList.length)+" ")]),e("div",{staticClass:"items"},t._l(t.list,function(i,s){return e("div",{key:s+i.vodid,staticClass:"item",class:{itemMin:t.isMin},on:{click:function(d){return t.itemClick(i)}}},[t.vodid==i.vodid&&t.videoUrl?e("video",{ref:"video"+i.vodid,refInFor:!0,staticClass:"video bananaListVideo",class:{videoMin:t.isMin},attrs:{controls:"controls",playsinline:"",autoplay:"",title:i.title,poster:i.coverpic,"picture-in-picture-mode":["push","pop"],src:t.videoUrl}}):e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:i.coverpic,expression:"item.coverpic"}],staticClass:"image",class:{imagemMin:t.isMin},attrs:{mode:"aspectFit"},on:{load:function(d){return t.loadImage(i,d)}}}),e("span",[t._v(t._s(i.title||i.catename)+" "+t._s(t.showVideoState(i)))]),e("div",{staticClass:"tips"},[i.isvip==1?e("span",{staticClass:"isvip"},[t._v(t._s(i.isvip==1?"vip":""))]):t._e(),i.definition>0&&!t.showKey?e("span",{staticClass:"definition"},[t._v(t._s(i.definition))]):t._e(),!t.isMin&&!t.showKey?e("span",{staticClass:"updatetime"},[t._v(t._s(i.updatetime))]):t._e(),t.showKey?t._e():e("span",{staticClass:"upnum"},[t._v(t._s(i.upnum))]),t.showKey?t._e():e("span",{staticClass:"scorenum"},[t._v(t._s(i.scorenum))]),t.showKey?e("span",{staticClass:"duration"},[t._v(t._s(i[t.showKey]))]):e("span",{staticClass:"duration"},[t._v(t._s(i.duration))])])])}),0)])},c=[];const p={props:{dataList:{default:()=>[]},info:{default:()=>({})},title:{default:""},isMin:{default:!1},showKey:{default:""}},data(){return{vodid:"",videoUrl:"",loading:"",isLoading:!1}},computed:{list(){return this.dataList.filter(t=>this.$store.state.banana.isVipShow||t.isvip!=1)}},watch:{dataList(t){this.updateItem()}},methods:{updateItem(){this.dataList.forEach(t=>{t.url=this.gerBVInfo()[t.vodid]||t.url||"",t.intro=t.url})},headerClick(){this.info.spid?this.$router.push({path:"./detail?spid="+this.info.spid}):this.$router.push({path:"./class"})},showVideoState(t){let a=t.intro||t.url;return a?a===5?"vip":a.startsWith&&a.startsWith("http")?"ok":"..":".."},loadImage(t,a){let e=a.target||a.path[0];e.src&&e.src.startsWith("http")&&this.itemClick(t,!0)},setBVInfo(t,a){let e=a.data.data.httpurl||a.data.data.httpurl_preview||a.data.retcode,i={};try{i=JSON.parse(localStorage.BVInfo)}catch{}i[t.vodid]=e,t.url=e,t.intro=e,localStorage.BVInfo=JSON.stringify(i),this.updateItem()},gerBVInfo(){try{return JSON.parse(localStorage.BVInfo)}catch{return{}}},itemClick(t,a){let e=t.url;if(e&&String(e).startsWith("http")){a||(this.videoUrl=e,this.vodid=t.vodid,this.hideOtherVideo(),document&&(document.title=t.title));return}else if(e){a||weui.topTips(e);return}a||(this.loading&&this.loading.hide(),this.loading=weui.loading()),t.vodid!=this.vodid&&(this.isLoading=!0,this.$axios({url:o.origin+t.play_url,params:o.query()}).then(i=>{this.isLoading=!1,this.setBVInfo(t,i),a||(this.loading&&this.loading.hide(),console.log("success",i),i.data.data.httpurl?(this.videoUrl=i.data.data.httpurl,this.vodid=t.vodid,this.hideOtherVideo()):i.data.data.httpurl_preview?(this.videoUrl=i.data.data.httpurl_preview,this.vodid=t.vodid,this.hideOtherVideo()):weui.topTips(i.data.errmsg||"fail"),document&&(document.title=t.title))}).catch(i=>{a||(this.loading&&this.loading.hide(),weui.topTips(i.message||"fail"))}))},hideOtherVideo(){setTimeout(()=>{this.$refs["video"+this.vodid][0].play();let t=new Array(...document.querySelectorAll(".bananaListVideo")).filter(a=>a.src!=this.videoUrl).forEach(a=>{a.pause(),a.parentElement.parentElement.parentElement.__vue__.vodid="",a.parentElement.parentElement.parentElement.__vue__.videoUrl=""});console.log(t)})}},destroyed(){this.loading&&this.loading.hide()}},r={};var h=n(p,l,c,!1,u,"c9120eda",null,null);function u(t){for(let a in r)this[a]=r[a]}var _=function(){return h.exports}();export{_ as default};
