{"version":3,"sources":["webpack:///./src/apps/banana/views/minVideo.vue?4ffa","webpack:///src/apps/banana/views/minVideo.vue","webpack:///./src/apps/banana/views/minVideo.vue?1589","webpack:///./src/apps/banana/views/minVideo.vue","webpack:///./src/apps/banana/views/minVideo.vue?1232","webpack:///./src/apps/banana/js/config.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","on","scroll","touchend","attrs","currentItem","videoUrl","vodrow","coverpic","_l","item","index","key","refInFor","$event","clickHandler","Math","abs","current","style","tipClick","_v","_s","user","nickname","title","updatetime","_e","staticRenderFns","data","rows","isShowMask","options","scrollY","isVideoLoading","isMoreLoading","computed","length","created","console","log","loadData","mounted","methods","changePage","$axios","$refs","video","play","e","stopPropagation","document","appendChild","watch","component","protocol","host","origin","query","device","s_device_id","s_os_version","s_platform","_t","home","Object","assign","Date","valueOf"],"mappings":"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","file":"js/chunk-4ca26e04.e03d79f7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"scroll\",staticClass:\"scroll\",on:{\"scroll\":_vm.scroll,\"touchend\":_vm.touchend}},[_c('video',{ref:\"video\",staticClass:\"video\",attrs:{\"controls\":\"controls\",\"playsinline\":\"\",\"autoplay\":\"\",\"src\":_vm.currentItem && _vm.currentItem.videoUrl,\"poster\":_vm.currentItem && _vm.currentItem.vodrow.coverpic}}),_vm._l((_vm.rows),function(item,index){return _c('div',{key:index,ref:'index' + index,refInFor:true,staticClass:\"swiperItem\",on:{\"click\":function($event){return _vm.clickHandler(item, index)}}},[(Math.abs(index - _vm.current) < 3)?_c('div',{staticClass:\"itemContent\"},[_c('div',{ref:'content' + index,refInFor:true,staticClass:\"content\"},[_c('img',{style:(_vm.current == index ? 'filter: blur(20px);' : ''),attrs:{\"src\":item.vodrow.coverpic}})]),(_vm.isShowMask)?_c('div',{staticClass:\"mask\",on:{\"click\":_vm.tipClick}},[_c('div',[_vm._v(\"@\"+_vm._s(item.user.nickname))]),_c('div',[_vm._v(_vm._s(item.vodrow.title))]),_c('div',[_vm._v(_vm._s(item.vodrow.updatetime))])]):_vm._e()]):_vm._e()])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"scroll\" ref=\"scroll\" @scroll=\"scroll\" @touchend=\"touchend\">\n    <video\n      class=\"video\"\n      controls=\"controls\"\n      ref=\"video\"\n      playsinline\n      autoplay\n      :src=\"currentItem && currentItem.videoUrl\"\n      :poster=\"currentItem && currentItem.vodrow.coverpic\"\n    ></video>\n    <div\n      class=\"swiperItem\"\n      v-for=\"(item, index) in rows\"\n      :key=\"index\"\n      @click=\"clickHandler(item, index)\"\n      :ref=\"'index' + index\"\n    >\n      <div class=\"itemContent\" v-if=\"Math.abs(index - current) < 3\">\n        <div class=\"content\" :ref=\"'content' + index\">\n          <img :src=\"item.vodrow.coverpic\" :style=\"current == index ? 'filter: blur(20px);' : ''\">\n        </div>\n        <div class=\"mask\" v-if=\"isShowMask\" @click=\"tipClick\">\n          <div>@{{item.user.nickname}}</div>\n          <div>{{item.vodrow.title}}</div>\n          <div>{{item.vodrow.updatetime}}</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport config from \"../js/config.js\";\nexport default {\n  data() {\n    return {\n      rows: [],\n      current: 0,\n      isShowMask: true,\n      options: {\n        scrollY: true\n      },\n      isVideoLoading: false,\n      isMoreLoading: false\n    };\n  },\n  computed: {\n    currentItem() {\n      return this.rows.length > 0 ? this.rows[this.current] : null;\n    }\n  },\n  created() {\n    console.log(\"created banana\");\n    this.loadData(true);\n  },\n  mounted() {\n    //   document.body.appendChild(this.$refs.swiperContainer)\n  },\n  methods: {\n    scroll(e) {\n      // console.log(\"scroll\", e);\n      let scrollTop = this.$refs.scroll.scrollTop;\n      let clientHeight = this.$refs.scroll.clientHeight;\n      let current = Math.round(scrollTop / clientHeight);\n      this.changePage(current);\n    },\n    touchend(e) {\n      return;\n      let scrollTop = this.$refs.scroll.scrollTop;\n      let clientHeight = this.$refs.scroll.clientHeight;\n      let current = Math.round(scrollTop / clientHeight);\n      this.current = current;\n      console.log(\"touchend\", scrollTop, current);\n      let item = this.$refs[\"index\" + current][0];\n      item.scrollIntoView({ behavior: \"smooth\" });\n      setTimeout(() => {\n        item.scrollIntoView({ behavior: \"smooth\" });\n      }, 1000);\n    },\n    loadData(isFirst) {\n      this.isMoreLoading = true\n      this.$axios\n        .request({\n          url: config.origin + \"/minivod/reqlist\",\n          params: config.query()\n        })\n        .then(res => {\n          this.isMoreLoading = false\n          console.log(\"success\", res);\n          if (res.status == 200 && res.data.retcode == 0) {\n            var rows = [];\n            res.data.data.rows.map(item => {\n              if (item.vodrow && item.vodrow.vodid) {\n                item.videoUrl = \"\";\n                rows.push(item);\n              }\n            });\n            if (isFirst) {\n              this.rows = rows;\n              this.changePage(0);\n            } else {\n              this.rows.push(rows[0]);\n            }\n          } else {\n            weui.topTips(res.data.errmsg || res.statusCode || \"fail\");\n          }\n        })\n        .catch(res => {\n          this.isMoreLoading = false\n          weui.topTips(res.message || \"fail\");\n        });\n    },\n    clickHandler(item, index) {\n      this.isShowMask = !this.isShowMask;\n    },\n    tipClick(e) {\n      this.$refs.video.play();\n      this.isShowMask = !this.isShowMask;\n      e.stopPropagation();\n    },\n    changePage(current) {\n      const item = this.rows[current];\n      const vodid = item.vodrow.vodid;\n      // console.log(\"swiperChange\", current, item);\n      if (document) {\n        document.title = item.vodrow.title;\n      }\n      this.current = current;\n      if (!item.videoUrl && !this.isVideoLoading) {\n        this.isVideoLoading = true;\n        this.$axios\n          .request({\n            url: config.origin + \"/minivod/reqplay/\" + vodid,\n            params: config.query()\n          })\n          .then(res => {\n            this.isVideoLoading = false;\n            console.log(\"success\", res);\n            var videoUrl =\n              res.data.data.httpurl || res.data.data.httpurl_preview;\n            if (videoUrl) {\n              console.log(videoUrl);\n              this.rows[current].videoUrl = videoUrl;\n              setTimeout(() => {\n                this.$refs[\"content\" + this.current][0].appendChild(\n                  this.$refs.video\n                );\n                this.$refs.video.play();\n              }, 20);\n            } else {\n              weui.topTips(res.data.errmsg || res.statusCode || \"fail\");\n            }\n          })\n          .catch(res => {\n            this.isVideoLoading = false;\n            weui.topTips(res.message || \"fail\");\n          });\n      } else if (\n        !this.$refs[\"content\" + this.current][0].querySelector(\".video\")\n      ) {\n        this.$refs[\"content\" + this.current][0].appendChild(this.$refs.video);\n      }\n      if (current == this.rows.length - 1 && !this.isMoreLoading) {\n        this.loadData();\n      }\n    }\n  },\n  watch: {}\n};\n</script>\n\n<style lang=\"less\" scoped>\n.video {\n  width: 100vw;\n  height: 100vh;\n  position: absolute;\n}\n.scroll {\n  height: 100vh;\n  overflow: auto;\n  .swiperItem {\n    width: calc(~\"100vw - 1px\");\n    height: 100vh;\n    border-bottom: 1px solid #000;\n    position: relative;\n    .itemContent {\n      width: 100%;\n      height: 100%;\n      .mask {\n        position: absolute;\n        left: 0;\n        bottom: 70px;\n        color: white;\n        padding: 5px 10px 5px 10px;\n        font-size: 13px;\n        z-index: 100;\n        background-color: rgba(0, 0, 0, 0.5);\n        opacity: 0.8;\n        display: inline;\n        // transform: translateX(-50%);\n        // left: 50%;\n        // text-align: center;\n      }\n      .content {\n        display: flex;\n        align-items: center;\n        height: 100%;\n        img {\n          height: auto;\n          width: 100%;\n          max-height: 100vh;\n          transition-duration: 3000ms;\n        }\n      }\n    }\n  }\n}\n\n.demo-text-1 {\n  background-color: red;\n}\n.demo-text-2 {\n  background-color: green;\n}\n.demo-text-3 {\n  background-color: blue;\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./minVideo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./minVideo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./minVideo.vue?vue&type=template&id=a815b4ac&scoped=true&\"\nimport script from \"./minVideo.vue?vue&type=script&lang=js&\"\nexport * from \"./minVideo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./minVideo.vue?vue&type=style&index=0&id=a815b4ac&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a815b4ac\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./minVideo.vue?vue&type=style&index=0&id=a815b4ac&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./minVideo.vue?vue&type=style&index=0&id=a815b4ac&lang=less&scoped=true&\"","const protocol = 'https:'\nconst host = '6jwti3892pf605m004mn.lagoapps.com'\nconst origin = protocol + '//' + host\nconst query = {\n\tdevice: 'iPhone 7 13.4 1.0',\n\ts_device_id: '374B5729-7F3F-4C8F-B6DE-80FF0A333633',\n\ts_os_version: '13.4',\n\ts_platform: 'ios',\n\t_t: '1587401036000'\n}\nexport default {\n\tprotocol,\n\thost,\n\torigin,\n\thome: origin + '/index',\n\tquery : () => Object.assign(query,{_t:new Date().valueOf()})\n}\n\n"],"sourceRoot":""}