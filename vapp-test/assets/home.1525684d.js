var v=Object.defineProperty,k=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var f=(l,t,i)=>t in l?v(l,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[t]=i,p=(l,t)=>{for(var i in t||(t={}))_.call(t,i)&&f(l,i,t[i]);if(g)for(var i of g(t))C.call(t,i)&&f(l,i,t[i]);return l},d=(l,t)=>k(l,y(t));import{H as $}from"./es.array.splice.37f4569b.js";import{n as D}from"./index.47e2b3c9.js";import"./array-method-has-species-support.518ddb83.js";var w=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"home"},[e("div",{staticClass:"inputArea"},[e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u5E01\u79CD")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.currencys,callback:function(a){t.$set(t.config,"currencys",a)},expression:"config.currencys"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u5468\u671F")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.period,callback:function(a){t.$set(t.config,"period",a)},expression:"config.period"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u6570\u91CF")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.size,callback:function(a){t.$set(t.config,"size",a)},expression:"config.size"}})],1)]),e("div",{staticClass:"buttons"},[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.getData}},[t._v("\u83B7\u53D6\u6570\u636E")]),e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.testClick()}}},[t._v(t._s(t.spotData.id||"\u83B7\u53D6\u8D26\u6237ID"))]),e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.testClick2()}}},[t._v("\u6D4B\u8BD52")]),e("el-button",{attrs:{type:"danger"},on:{click:function(a){t.$store.state.klineData=[]}}},[t._v("\u5220\u9664\u7F51\u7EDC\u6570\u636E")])],1),e("div",{staticClass:"data"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"currency",label:"currency",width:"80"}}),e("el-table-column",{attrs:{prop:"period",label:"period",width:"80"}}),e("el-table-column",{attrs:{prop:"price",label:"price",width:"80"}}),e("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),e("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),e("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),e("el-table-column",{attrs:{prop:"length",label:"length"}}),e("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(c){return t.handleClick(a,1)}}},[t._v("\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(c){return t.$store.state.klineData.splice(a.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),e("el-divider"),e("div",{staticClass:"inputArea"},[e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u6BCF\u7B14\u4EA4\u6613\u989D")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsSplit,callback:function(a){t.$set(t.config,"assetsSplit",a)},expression:"config.assetsSplit"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u9ED8\u8BA4U\u989D")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.assetsAll,callback:function(a){t.$set(t.config,"assetsAll",a)},expression:"config.assetsAll"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u4EA4\u6613\u6761\u4EF6")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.riseKey,callback:function(a){t.$set(t.config,"riseKey",a)},expression:"config.riseKey"}})],1),e("div",{staticClass:"item"},[e("div",{staticClass:"title"},[t._v("\u71C3\u6599\u8D39")]),e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},model:{value:t.config.gas,callback:function(a){t.$set(t.config,"gas",a)},expression:"config.gas"}})],1)]),e("div",{staticClass:"buttons"},[e("el-button",{attrs:{type:"primary",loading:t.loading2},on:{click:function(a){return t.calculate(t.klineData)}}},[t._v("\u5F00\u59CB\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger"},on:{click:function(a){t.$store.state.calculateData=[]}}},[t._v("\u5220\u9664\u8BA1\u7B97\u6570\u636E")])],1),e("div",{staticClass:"data"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{data:t.calculateData,border:""}},[e("el-table-column",{attrs:{prop:"currency",label:"currency"}}),e("el-table-column",{attrs:{prop:"period",label:"period"}}),e("el-table-column",{attrs:{prop:"income",label:"income",sortable:"",width:"200"}}),e("el-table-column",{attrs:{prop:"fprice",label:"fprice"}}),e("el-table-column",{attrs:{prop:"price",label:"price"}}),e("el-table-column",{attrs:{prop:"length",label:"length"}}),e("el-table-column",{attrs:{prop:"assetsAll",label:"\u9ED8\u8BA4U\u989D"}}),e("el-table-column",{attrs:{prop:"numAll",label:"\u9ED8\u8BA4\u5E01\u6570"}}),e("el-table-column",{attrs:{prop:"assets",label:"assets"}}),e("el-table-column",{attrs:{prop:"num",label:"num"}}),e("el-table-column",{attrs:{prop:"all1",label:"all1"}}),e("el-table-column",{attrs:{prop:"all2",label:"all2"}}),e("el-table-column",{attrs:{prop:"all3",label:"all3"}}),e("el-table-column",{attrs:{prop:"buyCount",label:"buyCount"}}),e("el-table-column",{attrs:{prop:"sellCount",label:"sellCount"}}),e("el-table-column",{attrs:{prop:"buyError",label:"buyError"}}),e("el-table-column",{attrs:{prop:"sellError",label:"sellError"}}),e("el-table-column",{attrs:{prop:"start",label:"start",width:"165"}}),e("el-table-column",{attrs:{prop:"end",label:"end",width:"165"}}),e("el-table-column",{attrs:{prop:"time",label:"time",width:"165"}}),e("el-table-column",{attrs:{fixed:"right",label:"\u64CD\u4F5C",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(c){return t.handleClick(a,2)}}},[t._v("\u8BA1\u7B97")]),e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(c){return t.$store.state.calculateData.splice(a.$index,1)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),e("el-divider")],1)},x=[];var h=window.axios;let{mapState:A,mapMutations:K,mapGetters:L}=Vuex;const F={name:"Home",components:{HelloWorld:$},data(){return{input:"",loading:!1,loading2:!1}},computed:d(p({},A({config:l=>l.config,urls:l=>l.urls,klineData:l=>l.klineData,calculateData:l=>l.calculateData,spotData:l=>l.accounts.filter(t=>t.type=="spot")[0]||{}})),{currencys(){return this.config.currencys.split(",")},periods(){return this.config.period.split(",")},tableData(){return this.klineData.map(l=>({currency:l.currency,period:l.period,price:l.price,length:l.list.length,start:o(l.list[0].id*1e3),end:o(l.list[l.list.length-1].id*1e3),time:o()}))}}),methods:{testClick(){let l=this.$util.huobiParams({},this.urls.accounts,"get");return console.log(l),new Promise((t,i)=>{h({method:"get",url:this.urls.accounts,params:l}).then(e=>{e.data["err-msg"]?console.log(e.data["err-msg"]):this.$store.state.accounts=e.data.data}).catch(e=>{b("\u9519\u8BEF:testCLick",e),t([])})})},testClick2(){let l=`https://api.huobi.pro/v1/account/accounts/${this.spotData.id}/balance`,t=this.$util.huobiParams({},l,"get");return console.log(t),new Promise((i,e)=>{h({method:"get",url:l,params:t}).then(s=>{if(s.data["err-msg"])console.log(s.data["err-msg"]);else{let r=s.data.data.list.filter(c=>["usdt","btc3l","btc3s"].includes(c.currency)&&c.type=="trade");console.log("arr",r)}}).catch(s=>{b("\u9519\u8BEF:testCLick",s),i([])})})},handleClick(l,t){t==1?this.$store.state.calculateData=[...this.calculate1([this.klineData[l.$index]]),...this.$store.state.calculateData]:t==2&&this.$store.state.calculateData.splice(l.$index,1,this.calculate1([this.calculateData[l.$index].item])[0])},getData(){let l=this.currencys,t=this.periods,i=[],e=[];l.forEach(s=>{t.forEach(a=>{i.push(S(s,a,this.config,this.urls.klineUrl)),e.push({currency:s,period:a,list:[],price:0})})}),console.log(l),console.log(t),this.loading=!0,Promise.all(i).then(s=>{this.loading=!1,s.forEach((a,r)=>{e[r].list=[...a].reverse(),e[r].price=e[r].list[0].close}),this.$store.state.klineData=[...e,...this.$store.state.klineData]}).catch(s=>{console.log(s)})},calculate(l){this.loading2=!0,this.$store.state.calculateData=[...this.calculate1(l),...this.$store.state.calculateData],this.loading2=!1},calculate1(l){return l.map(t=>this.calculate2(t))},calculate2(l){let t={buyCount:0,sellCount:0,buyError:0,sellError:0},i=parseFloat(this.config.assetsAll),e=parseFloat(this.config.assetsAll)/l.price,s=l.list;s.some((r,c)=>{let n=(r.close-r.open)/r.open;if(Math.abs(n)>parseFloat(this.config.riseKey)){let u=parseFloat(this.config.assetsSplit)/r.close;n>0?e>u?(i+=parseFloat(this.config.assetsSplit)*(1-parseFloat(this.config.gas)),e-=u,t.sellCount++):t.sellError++:i>parseFloat(this.config.assetsSplit)?(i-=parseFloat(this.config.assetsSplit),e+=u*(1-parseFloat(this.config.gas)),t.buyCount++):t.buyError++}});let a=d(p({currency:l.currency,period:l.period,fprice:l.list[0].close,price:l.list[l.list.length-1].close,length:l.list.length,all1:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/l.price*s[0].close,all2:parseFloat(this.config.assetsAll)+parseFloat(this.config.assetsAll)/l.price*s[s.length-1].close,all3:i+e*s[s.length-1].close,start:o(l.list[0].id*1e3),end:o(l.list[l.list.length-1].id*1e3),time:o(),assetsAll:this.config.assetsAll,numAll:parseFloat(this.config.assetsAll)/l.price,assets:i,num:e},t),{item:l});return a.income=a.all3-a.all1,a}}};function S(l,t,i,e){let s=i.size,a={symbol:(l+"usdt").toLowerCase(),period:t,size:s};return new Promise((r,c)=>{h({method:"get",url:e,params:a}).then(n=>{let u=n.data.data;r(u)}).catch(n=>{b("\u9519\u8BEF:GetRecords",n),r([])})})}function o(l){return window.dayjs(l).format("YYYY-MM-DD HH:mm:ss")}function b(){console.log(o(),...arguments)}const m={};var E=D(F,w,x,!1,z,null,null,null);function z(l){for(let t in m)this[t]=m[t]}var Y=function(){return E.exports}();export{Y as default};
